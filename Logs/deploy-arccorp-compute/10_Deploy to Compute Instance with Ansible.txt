2025-09-07T15:57:52.1784591Z ##[group]Run echo "=== Starting Ansible deployment ==="
2025-09-07T15:57:52.1785282Z [36;1mecho "=== Starting Ansible deployment ==="[0m
2025-09-07T15:57:52.1785804Z [36;1m[0m
2025-09-07T15:57:52.1786239Z [36;1m# Set environment variables for Ansible[0m
2025-09-07T15:57:52.1787035Z [36;1mexport DISCORD_TOKEN=***[0m
2025-09-07T15:57:52.1787580Z [36;1mexport TEXT_CHANNEL_ID=***[0m
2025-09-07T15:57:52.1788380Z [36;1mexport DATABASE_URL=***[0m
2025-09-07T15:57:52.1788844Z [36;1m[0m
2025-09-07T15:57:52.1789295Z [36;1m# Run Ansible playbook with dynamic inventory[0m
2025-09-07T15:57:52.1790094Z [36;1mDISCORD_TOKEN=*** \[0m
2025-09-07T15:57:52.1790614Z [36;1mTEXT_CHANNEL_ID=*** \[0m
2025-09-07T15:57:52.1791366Z [36;1mDATABASE_URL=*** \[0m
2025-09-07T15:57:52.1791975Z [36;1mansible-playbook ansible/deploy.yml -i /tmp/ansible/inventory.ini -v[0m
2025-09-07T15:57:52.1792848Z [36;1m[0m
2025-09-07T15:57:52.1793298Z [36;1mecho "=== Ansible deployment completed ==="[0m
2025-09-07T15:57:52.1793851Z [36;1m[0m
2025-09-07T15:57:52.1794282Z [36;1mecho "=== Waiting for bot to stabilize ==="[0m
2025-09-07T15:57:52.1794783Z [36;1msleep 10[0m
2025-09-07T15:57:52.1795232Z [36;1mecho "=== Bot startup wait completed ==="[0m
2025-09-07T15:57:52.1827195Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail ***0***
2025-09-07T15:57:52.1827798Z env:
2025-09-07T15:57:52.1828462Z   DATABASE_URL: ***
2025-09-07T15:57:52.1829203Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:52.1830255Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:52.1831229Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:52.1831939Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1832691Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1833400Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1833875Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1834339Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1834914Z   pythonLocation: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1835593Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib/pkgconfig
2025-09-07T15:57:52.1836261Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1836872Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1837488Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1838090Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib
2025-09-07T15:57:52.1838627Z ##[endgroup]
2025-09-07T15:57:52.1893285Z === Starting Ansible deployment ===
2025-09-07T15:57:53.2767041Z Using /home/runner/work/red-legion-bots/red-legion-bots/ansible.cfg as config file
2025-09-07T15:57:53.2767860Z 
2025-09-07T15:57:53.2768391Z PLAY [Deploy Participation Bot] ************************************************
2025-09-07T15:57:53.2769136Z 
2025-09-07T15:57:53.2769598Z TASK [Gathering Facts] *********************************************************
2025-09-07T15:57:57.4138640Z ok: [34.30.73.146]
2025-09-07T15:57:57.4139049Z 
2025-09-07T15:57:57.4139446Z TASK [Update apt cache] ********************************************************
2025-09-07T15:58:03.9127206Z changed: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": true, "changed": true***
2025-09-07T15:58:03.9127765Z 
2025-09-07T15:58:03.9128112Z TASK [Install required system packages] ****************************************
2025-09-07T15:58:07.0295867Z ok: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": false, "changed": false***
2025-09-07T15:58:07.0296747Z 
2025-09-07T15:58:07.0297345Z TASK [Try installing postgresql-client] ****************************************
2025-09-07T15:58:09.7204390Z ok: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": false, "changed": false***
2025-09-07T15:58:09.7205448Z 
2025-09-07T15:58:09.7206006Z TASK [Try alternative PostgreSQL client package names] *************************
2025-09-07T15:58:09.7854997Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pg_client_install.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:09.7855931Z 
2025-09-07T15:58:09.7856387Z TASK [Install minimal PostgreSQL development files if others failed] ***********
2025-09-07T15:58:09.8128939Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pg_client_install.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:09.8129633Z 
2025-09-07T15:58:09.8129980Z TASK [Install pip using ensurepip (built into Python 3.4+)] ********************
2025-09-07T15:58:11.4787587Z fatal: [34.30.73.146]: FAILED! => ***"changed": true, "cmd": ["python3", "-m", "ensurepip", "--upgrade"], "delta": "0:00:00.027306", "end": "2025-09-07 15:58:11.291733", "msg": "non-zero return code", "rc": 1, "start": "2025-09-07 15:58:11.264427", "stderr": "/usr/bin/python3: No module named ensurepip", "stderr_lines": ["/usr/bin/python3: No module named ensurepip"], "stdout": "", "stdout_lines": []***
2025-09-07T15:58:11.4789132Z ...ignoring
2025-09-07T15:58:11.4789364Z 
2025-09-07T15:58:11.4789693Z TASK [Install pip via apt if ensurepip failed] *********************************
2025-09-07T15:58:13.9832920Z ok: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": false, "changed": false***
2025-09-07T15:58:13.9833561Z 
2025-09-07T15:58:13.9833946Z TASK [Download get-pip.py] *****************************************************
2025-09-07T15:58:14.0129491Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "apt_pip_result.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:14.0130194Z 
2025-09-07T15:58:14.0130541Z TASK [Install pip using get-pip.py] ********************************************
2025-09-07T15:58:14.0430956Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "apt_pip_result.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:14.0431835Z 
2025-09-07T15:58:14.0432194Z TASK [Clean up get-pip.py] *****************************************************
2025-09-07T15:58:14.0735070Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "apt_pip_result.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:14.0735929Z 
2025-09-07T15:58:14.0736294Z TASK [Check pip3 command] ******************************************************
2025-09-07T15:58:16.3458106Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["pip3", "--version"], "delta": "0:00:00.728103", "end": "2025-09-07 15:58:16.155588", "msg": "", "rc": 0, "start": "2025-09-07 15:58:15.427485", "stderr": "", "stderr_lines": [], "stdout": "pip 25.2 from /root/.local/lib/python3.10/site-packages/pip (python 3.10)", "stdout_lines": ["pip 25.2 from /root/.local/lib/python3.10/site-packages/pip (python 3.10)"]***
2025-09-07T15:58:16.3459871Z 
2025-09-07T15:58:16.3460191Z TASK [Check python3 -m pip] ****************************************************
2025-09-07T15:58:16.3724134Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pip3_check.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:16.3724841Z 
2025-09-07T15:58:16.3725138Z TASK [Display pip status] ******************************************************
2025-09-07T15:58:16.4021578Z ok: [34.30.73.146] => ***
2025-09-07T15:58:16.4022241Z     "msg": "pip3 command: Available\npython3 -m pip: Available\n"
2025-09-07T15:58:16.4023063Z ***
2025-09-07T15:58:16.4023271Z 
2025-09-07T15:58:16.4023580Z TASK [Fail if no pip method works] *********************************************
2025-09-07T15:58:16.4300387Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pip3_check.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:16.4301529Z 
2025-09-07T15:58:16.4301900Z TASK [Upgrade pip to latest version] *******************************************
2025-09-07T15:58:20.1763815Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "-m", "pip", "install", "--user", "--upgrade", "pip"], "delta": "0:00:02.188197", "end": "2025-09-07 15:58:19.974850", "msg": "", "rc": 0, "start": "2025-09-07 15:58:17.786653", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning."], "stdout": "Requirement already satisfied: pip in /root/.local/lib/python3.10/site-packages (25.2)", "stdout_lines": ["Requirement already satisfied: pip in /root/.local/lib/python3.10/site-packages (25.2)"]***
2025-09-07T15:58:20.1768334Z 
2025-09-07T15:58:20.1768680Z TASK [Check if Google Cloud SDK is available] **********************************
2025-09-07T15:58:21.6919483Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["which", "gcloud"], "delta": "0:00:00.006132", "end": "2025-09-07 15:58:21.506278", "msg": "", "rc": 0, "start": "2025-09-07 15:58:21.500146", "stderr": "", "stderr_lines": [], "stdout": "/snap/bin/gcloud", "stdout_lines": ["/snap/bin/gcloud"]***
2025-09-07T15:58:21.6920628Z 
2025-09-07T15:58:21.6921000Z TASK [Install Google Cloud SDK] ************************************************
2025-09-07T15:58:21.7082692Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "gcloud_check.rc != 0", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:21.7084052Z 
2025-09-07T15:58:21.7084525Z TASK [Stop existing bot process] ***********************************************
2025-09-07T15:58:21.7298263Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/stop_bot.yml for 34.30.73.146
2025-09-07T15:58:21.7298911Z 
2025-09-07T15:58:21.7299267Z TASK [Check if systemd service exists] *****************************************
2025-09-07T15:58:23.2585758Z ok: [34.30.73.146] => ***"changed": false, "stat": ***"exists": false***
2025-09-07T15:58:23.2586271Z 
2025-09-07T15:58:23.2586576Z TASK [Stop systemd service] ****************************************************
2025-09-07T15:58:23.2752876Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "systemd_service.stat.exists", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:23.2754006Z 
2025-09-07T15:58:23.2754598Z TASK [Kill any running bot processes] ******************************************
2025-09-07T15:58:24.7180572Z fatal: [34.30.73.146]: FAILED! => ***"changed": true, "cmd": "pkill -f \"python.*participation_bot\" || true", "delta": "0:00:00.018770", "end": "2025-09-07 15:58:24.523953", "msg": "non-zero return code", "rc": -15, "start": "2025-09-07 15:58:24.505183", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []***
2025-09-07T15:58:24.7182056Z ...ignoring
2025-09-07T15:58:24.7182451Z 
2025-09-07T15:58:24.7182840Z TASK [Wait for processes to terminate] *****************************************
2025-09-07T15:58:27.7387902Z Pausing for 3 seconds
2025-09-07T15:58:27.7389546Z ok: [34.30.73.146] => ***"changed": false, "delta": 3, "echo": true, "rc": 0, "start": "2025-09-07 15:58:24.725397", "stderr": "", "stdout": "Paused for 3.0 seconds", "stop": "2025-09-07 15:58:27.729713", "user_input": ""***
2025-09-07T15:58:27.7390665Z 
2025-09-07T15:58:27.7390994Z TASK [Force kill any remaining bot processes] **********************************
2025-09-07T15:58:29.2666022Z fatal: [34.30.73.146]: FAILED! => ***"changed": true, "cmd": "pkill -9 -f \"python.*participation_bot\" || true", "delta": "0:00:00.012144", "end": "2025-09-07 15:58:29.080344", "msg": "non-zero return code", "rc": -9, "start": "2025-09-07 15:58:29.068200", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []***
2025-09-07T15:58:29.2668110Z ...ignoring
2025-09-07T15:58:29.2668482Z 
2025-09-07T15:58:29.2668981Z TASK [Check if bot PID file exists] ********************************************
2025-09-07T15:58:30.7050162Z ok: [34.30.73.146] => ***"changed": false, "stat": ***"exists": false***
2025-09-07T15:58:30.7050706Z 
2025-09-07T15:58:30.7051061Z TASK [Remove PID file] *********************************************************
2025-09-07T15:58:32.2778728Z ok: [34.30.73.146] => ***"changed": false, "path": "/app/bot.pid", "state": "absent"***
2025-09-07T15:58:32.2779281Z 
2025-09-07T15:58:32.2779663Z TASK [Clean and prepare application directory] *********************************
2025-09-07T15:58:33.7376020Z ok: [34.30.73.146] => ***"changed": false, "path": "/app", "state": "absent"***
2025-09-07T15:58:33.7376610Z 
2025-09-07T15:58:33.7377028Z TASK [Create application directory] ********************************************
2025-09-07T15:58:35.1797980Z changed: [34.30.73.146] => ***"changed": true, "gid": 1000, "group": "ubuntu", "mode": "0755", "owner": "ubuntu", "path": "/app", "size": 4096, "state": "directory", "uid": 1000***
2025-09-07T15:58:35.1798812Z 
2025-09-07T15:58:35.1799184Z TASK [Copy application code] ***************************************************
2025-09-07T16:09:13.9099132Z changed: [34.30.73.146] => ***"changed": true, "dest": "/app/", "src": "/home/runner/work/red-legion-bots/red-legion-bots/"***
2025-09-07T16:09:13.9099838Z 
2025-09-07T16:09:13.9100244Z TASK [Install requirements with pip3 (system-wide)] ****************************
2025-09-07T16:09:17.5597093Z ok: [34.30.73.146] => ***"changed": false, "cmd": ["/usr/bin/pip3", "install", "-r", "/app/requirements.txt"], "name": null, "requirements": "/app/requirements.txt", "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning."], "stdout": "Requirement already satisfied: discord.py==2.4.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 1)) (2.4.0)\nRequirement already satisfied: psycopg2-binary==2.9.9 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 2)) (2.9.9)\nRequirement already satisfied: python-dotenv==1.0.1 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 3)) (1.0.1)\nRequirement already satisfied: aiohttp==3.9.5 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 4)) (3.9.5)\nRequirement already satisfied: psutil==5.9.8 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 5)) (5.9.8)\nRequirement already satisfied: asyncpg==0.29.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 6)) (0.29.0)\nRequirement already satisfied: google-cloud-secret-manager==2.20.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 7)) (2.20.0)\nRequirement already satisfied: reportlab==4.0.4 in /usr/local/lib/python3.10/dist-packages (from -r /app/requirements.txt (line 8)) (4.0.4)\nRequirement already satisfied: aiosignal>=1.1.2 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.4.0)\nRequirement already satisfied: attrs>=17.3.0 in /usr/lib/python3/dist-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (21.2.0)\nRequirement already satisfied: frozenlist>=1.1.1 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.7.0)\nRequirement already satisfied: multidict<7.0,>=4.5 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (6.6.4)\nRequirement already satisfied: yarl<2.0,>=1.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.20.1)\nRequirement already satisfied: async-timeout<5.0,>=4.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.0.3)\nRequirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)\nRequirement already satisfied: google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.40.3)\nRequirement already satisfied: proto-plus<2.0.0dev,>=1.22.3 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.26.1)\nRequirement already satisfied: protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.25.8)\nRequirement already satisfied: grpc-google-iam-v1<1.0.0dev,>=0.12.4 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.14.2)\nRequirement already satisfied: pillow>=9.0.0 in /usr/local/lib/python3.10/dist-packages (from reportlab==4.0.4->-r /app/requirements.txt (line 8)) (11.3.0)\nRequirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in /root/.local/lib/python3.10/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.70.0)\nRequirement already satisfied: requests<3.0.0,>=2.18.0 in /usr/lib/python3/dist-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)\nRequirement already satisfied: grpcio<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.74.0)\nRequirement already satisfied: grpcio-status<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.62.3)\nRequirement already satisfied: cachetools<6.0,>=2.0.0 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (5.5.2)\nRequirement already satisfied: pyasn1-modules>=0.2.1 in /usr/lib/python3/dist-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.2.1)\nRequirement already satisfied: rsa<5,>=3.1.4 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.9.1)\nRequirement already satisfied: typing-extensions>=4.1.0 in /root/.local/lib/python3.10/site-packages (from multidict<7.0,>=4.5->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.15.0)\nRequirement already satisfied: pyasn1>=0.1.3 in /usr/lib/python3/dist-packages (from rsa<5,>=3.1.4->google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.4.8)\nRequirement already satisfied: idna>=2.0 in /usr/lib/python3/dist-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (3.3)\nRequirement already satisfied: propcache>=0.2.1 in /root/.local/lib/python3.10/site-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (0.3.2)\n", "stdout_lines": ["Requirement already satisfied: discord.py==2.4.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 1)) (2.4.0)", "Requirement already satisfied: psycopg2-binary==2.9.9 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 2)) (2.9.9)", "Requirement already satisfied: python-dotenv==1.0.1 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 3)) (1.0.1)", "Requirement already satisfied: aiohttp==3.9.5 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 4)) (3.9.5)", "Requirement already satisfied: psutil==5.9.8 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 5)) (5.9.8)", "Requirement already satisfied: asyncpg==0.29.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 6)) (0.29.0)", "Requirement already satisfied: google-cloud-secret-manager==2.20.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 7)) (2.20.0)", "Requirement already satisfied: reportlab==4.0.4 in /usr/local/lib/python3.10/dist-packages (from -r /app/requirements.txt (line 8)) (4.0.4)", "Requirement already satisfied: aiosignal>=1.1.2 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.4.0)", "Requirement already satisfied: attrs>=17.3.0 in /usr/lib/python3/dist-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (21.2.0)", "Requirement already satisfied: frozenlist>=1.1.1 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.7.0)", "Requirement already satisfied: multidict<7.0,>=4.5 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (6.6.4)", "Requirement already satisfied: yarl<2.0,>=1.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.20.1)", "Requirement already satisfied: async-timeout<5.0,>=4.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.0.3)", "Requirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)", "Requirement already satisfied: google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.40.3)", "Requirement already satisfied: proto-plus<2.0.0dev,>=1.22.3 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.26.1)", "Requirement already satisfied: protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.25.8)", "Requirement already satisfied: grpc-google-iam-v1<1.0.0dev,>=0.12.4 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.14.2)", "Requirement already satisfied: pillow>=9.0.0 in /usr/local/lib/python3.10/dist-packages (from reportlab==4.0.4->-r /app/requirements.txt (line 8)) (11.3.0)", "Requirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in /root/.local/lib/python3.10/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.70.0)", "Requirement already satisfied: requests<3.0.0,>=2.18.0 in /usr/lib/python3/dist-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)", "Requirement already satisfied: grpcio<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.74.0)", "Requirement already satisfied: grpcio-status<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.62.3)", "Requirement already satisfied: cachetools<6.0,>=2.0.0 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (5.5.2)", "Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/lib/python3/dist-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.2.1)", "Requirement already satisfied: rsa<5,>=3.1.4 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.9.1)", "Requirement already satisfied: typing-extensions>=4.1.0 in /root/.local/lib/python3.10/site-packages (from multidict<7.0,>=4.5->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.15.0)", "Requirement already satisfied: pyasn1>=0.1.3 in /usr/lib/python3/dist-packages (from rsa<5,>=3.1.4->google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.4.8)", "Requirement already satisfied: idna>=2.0 in /usr/lib/python3/dist-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (3.3)", "Requirement already satisfied: propcache>=0.2.1 in /root/.local/lib/python3.10/site-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (0.3.2)"], "version": null, "virtualenv": null***
2025-09-07T16:09:17.5638197Z 
2025-09-07T16:09:17.5638562Z TASK [Install psycopg2-binary with pip3 (system-wide)] *************************
2025-09-07T16:09:20.0055897Z ok: [34.30.73.146] => ***"changed": false, "cmd": ["/usr/bin/pip3", "install", "psycopg2-binary"], "name": ["psycopg2-binary"], "requirements": null, "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning."], "stdout": "Requirement already satisfied: psycopg2-binary in /root/.local/lib/python3.10/site-packages (2.9.9)\n", "stdout_lines": ["Requirement already satisfied: psycopg2-binary in /root/.local/lib/python3.10/site-packages (2.9.9)"], "version": null, "virtualenv": null***
2025-09-07T16:09:20.0063697Z 
2025-09-07T16:09:20.0064268Z TASK [Set up environment variables] ********************************************
2025-09-07T16:09:20.0266857Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/setup_environment.yml for 34.30.73.146
2025-09-07T16:09:20.0267645Z 
2025-09-07T16:09:20.0268083Z TASK [Set PYTHONPATH environment variable] *************************************
2025-09-07T16:09:21.6424778Z ok: [34.30.73.146] => ***"backup": "", "changed": false, "msg": ""***
2025-09-07T16:09:21.6425521Z 
2025-09-07T16:09:21.6426061Z TASK [Remove any cached .env files that might cause conflicts] *****************
2025-09-07T16:09:23.0606770Z ok: [34.30.73.146] => ***"changed": false, "path": "/app/.env", "state": "absent"***
2025-09-07T16:09:23.0607557Z 
2025-09-07T16:09:23.0608061Z TASK [Test Python imports] *****************************************************
2025-09-07T16:09:27.5840742Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "-c", "import sys; print('Python path:', sys.path); import src.participation_bot"], "delta": "0:00:03.070838", "end": "2025-09-07 16:09:27.378962", "failed_when_result": false, "msg": "", "rc": 0, "start": "2025-09-07 16:09:24.308124", "stderr": "", "stderr_lines": [], "stdout": "Python path: ['', '/app', '/app/$PYTHONPATH', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/root/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']\nDatabase URL encoding: Fixed special characters in password", "stdout_lines": ["Python path: ['', '/app', '/app/$PYTHONPATH', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/root/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']", "Database URL encoding: Fixed special characters in password"]***
2025-09-07T16:09:27.5844895Z 
2025-09-07T16:09:27.5845267Z TASK [Start bot service] *******************************************************
2025-09-07T16:09:27.6092504Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/start_bot.yml for 34.30.73.146
2025-09-07T16:09:27.6093474Z 
2025-09-07T16:09:27.6093919Z TASK [Run configuration validation] ********************************************
2025-09-07T16:09:30.2003792Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "scripts/validate_config.py"], "delta": "0:00:01.064743", "end": "2025-09-07 16:09:30.012654", "msg": "", "rc": 0, "start": "2025-09-07 16:09:28.947911", "stderr": "", "stderr_lines": [], "stdout": "🎯 Red Legion Bot Configuration Validator\n==================================================\n🧪 Testing imports...\n   ✅ Config imports successful\n🧪 Testing environment configuration...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database URL configured\n   ✅ Discord token configured\n🧪 Testing database connection...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database connection successful\n🧪 Testing Secret Manager access...\n   ✅ Secret Manager accessible (test secret not found, which is expected)\n\n==================================================\n📊 Validation Results:\n   ✅ PASS Imports\n   ✅ PASS Environment\n   ✅ PASS Database Connection\n   ✅ PASS Secret Manager\n\n🎉 All validation tests passed! Bot is ready to start.", "stdout_lines": ["🎯 Red Legion Bot Configuration Validator", "==================================================", "🧪 Testing imports...", "   ✅ Config imports successful", "🧪 Testing environment configuration...", "Database URL encoding: Fixed special characters in password", "   ✅ Database URL configured", "   ✅ Discord token configured", "🧪 Testing database connection...", "Database URL encoding: Fixed special characters in password", "   ✅ Database connection successful", "🧪 Testing Secret Manager access...", "   ✅ Secret Manager accessible (test secret not found, which is expected)", "", "==================================================", "📊 Validation Results:", "   ✅ PASS Imports", "   ✅ PASS Environment", "   ✅ PASS Database Connection", "   ✅ PASS Secret Manager", "", "🎉 All validation tests passed! Bot is ready to start."]***
2025-09-07T16:09:30.2015986Z 
2025-09-07T16:09:30.2016587Z TASK [Show configuration validation result] ************************************
2025-09-07T16:09:30.2263640Z ok: [34.30.73.146] => ***
2025-09-07T16:09:30.2268402Z     "msg": "Configuration validation: PASSED - 🎯 Red Legion Bot Configuration Validator\n==================================================\n🧪 Testing imports...\n   ✅ Config imports successful\n🧪 Testing environment configuration...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database URL configured\n   ✅ Discord token configured\n🧪 Testing database connection...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database connection successful\n🧪 Testing Secret Manager access...\n   ✅ Secret Manager accessible (test secret not found, which is expected)\n\n==================================================\n📊 Validation Results:\n   ✅ PASS Imports\n   ✅ PASS Environment\n   ✅ PASS Database Connection\n   ✅ PASS Secret Manager\n\n🎉 All validation tests passed! Bot is ready to start."
2025-09-07T16:09:30.2272770Z ***
2025-09-07T16:09:30.2273044Z 
2025-09-07T16:09:30.2273483Z TASK [Test Python imports before starting bot] *********************************
2025-09-07T16:09:32.3567513Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "-c", "import sys; sys.path.insert(0, 'src'); from config.settings import get_database_url; print('Import successful, DB URL configured:', bool(get_database_url()))"], "delta": "0:00:00.594193", "end": "2025-09-07 16:09:32.165976", "msg": "", "rc": 0, "start": "2025-09-07 16:09:31.571783", "stderr": "", "stderr_lines": [], "stdout": "Database URL encoding: Fixed special characters in password\nImport successful, DB URL configured: True", "stdout_lines": ["Database URL encoding: Fixed special characters in password", "Import successful, DB URL configured: True"]***
2025-09-07T16:09:32.3569857Z 
2025-09-07T16:09:32.3570203Z TASK [Show import test result] *************************************************
2025-09-07T16:09:32.3823678Z ok: [34.30.73.146] => ***
2025-09-07T16:09:32.3824657Z     "msg": "Import test result: Database URL encoding: Fixed special characters in password\nImport successful, DB URL configured: True"
2025-09-07T16:09:32.3825496Z ***
2025-09-07T16:09:32.3825705Z 
2025-09-07T16:09:32.3826040Z TASK [Create environment file from template] ***********************************
2025-09-07T16:09:35.6302583Z changed: [34.30.73.146] => ***"changed": true, "checksum": "a974a4f3ee2ec4647427d36713d12cb9940147b7", "dest": "/app/.env", "gid": 0, "group": "root", "md5sum": "87eb36bf35058f17fde58db0ef954cb3", "mode": "0600", "owner": "root", "size": 252, "src": "/home/ubuntu/.ansible/tmp/ansible-tmp-1757261372.5146785-5251-90852088897410/source", "state": "file", "uid": 0***
2025-09-07T16:09:35.6304606Z 
2025-09-07T16:09:35.6305018Z TASK [Create systemd service file] *********************************************
2025-09-07T16:09:38.7522878Z changed: [34.30.73.146] => ***"changed": true, "checksum": "20aa619ed0f91e7f49f85c45ed43910fbf031864", "dest": "/etc/systemd/system/red-legion-bot.service", "gid": 0, "group": "root", "md5sum": "2f294916dcc7f3444ac821921d97a336", "mode": "0644", "owner": "root", "size": 430, "src": "/home/ubuntu/.ansible/tmp/ansible-tmp-1757261375.7566345-5267-248483539279290/source", "state": "file", "uid": 0***
2025-09-07T16:09:38.7524529Z 
2025-09-07T16:09:38.7524872Z TASK [Reload systemd daemon] ***************************************************
2025-09-07T16:09:41.1740013Z ok: [34.30.73.146] => ***"changed": false, "name": null, "status": ***
2025-09-07T16:09:41.1740574Z 
2025-09-07T16:09:41.1740936Z TASK [Enable and start systemd service] ****************************************
2025-09-07T16:09:43.3800044Z changed: [34.30.73.146] => ***"changed": true, "enabled": true, "name": "red-legion-bot", "state": "started", "status": ***"ActiveEnterTimestamp": "n/a", "ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "network-online.target basic.target -.mount systemd-journald.socket network.target system.slice sysinit.target", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestamp": "n/a", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestamp": "n/a", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Red Legion Discord Bot", "DevicePolicy": "auto", "DynamicUser": "no", "Environment": "PYTHONUNBUFFERED=1 GOOGLE_CLOUD_PROJECT=rl-prod-471116", "EnvironmentFiles": "/app/.env (ignore_errors=no)", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestamp": "n/a", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecStart": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 ***", "ExecStartEx": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 ***", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/etc/systemd/system/red-legion-bot.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "red-legion-bot.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "n/a", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "2190", "LimitNPROCSoft": "2190", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "2190", "LimitSIGPENDINGSoft": "2190", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "red-legion-bot.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "-.mount sysinit.target system.slice", "RequiresMountsFor": "/app", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "10s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "journal", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "n/a", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "657", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "User": "root", "UtmpMode": "init", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity", "WorkingDirectory": "/app"***
2025-09-07T16:09:43.3824449Z 
2025-09-07T16:09:43.3824767Z TASK [Show startup debug info] *************************************************
2025-09-07T16:09:43.4033542Z ok: [34.30.73.146] => ***
2025-09-07T16:09:43.4034083Z     "msg": "Systemd service started: True"
2025-09-07T16:09:43.4034619Z ***
2025-09-07T16:09:43.4034844Z 
2025-09-07T16:09:43.4035142Z TASK [Wait for bot to start] ***************************************************
2025-09-07T16:09:46.4277721Z Pausing for 3 seconds
2025-09-07T16:09:46.4279041Z ok: [34.30.73.146] => ***"changed": false, "delta": 3, "echo": true, "rc": 0, "start": "2025-09-07 16:09:43.414272", "stderr": "", "stdout": "Paused for 3.0 seconds", "stop": "2025-09-07 16:09:46.418649", "user_input": ""***
2025-09-07T16:09:46.4279973Z 
2025-09-07T16:09:46.4280371Z TASK [Verify bot service is running] *******************************************
2025-09-07T16:09:48.2574436Z ok: [34.30.73.146] => ***"changed": false, "name": "red-legion-bot", "status": ***"ActiveEnterTimestamp": "Sun 2025-09-07 16:09:43 UTC", "ActiveEnterTimestampMonotonic": "3850363229", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "network-online.target basic.target systemd-journald.socket -.mount sysinit.target network.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-09-07 16:09:43 UTC", "AssertTimestampMonotonic": "3850356174", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "494091000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-09-07 16:09:43 UTC", "ConditionTimestampMonotonic": "3850356172", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/red-legion-bot.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Red Legion Discord Bot", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "PYTHONUNBUFFERED=1 GOOGLE_CLOUD_PROJECT=rl-prod-471116", "EnvironmentFiles": "/app/.env (ignore_errors=no)", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "16618", "ExecMainStartTimestamp": "Sun 2025-09-07 16:09:43 UTC", "ExecMainStartTimestampMonotonic": "3850361182", "ExecMainStatus": "0", "ExecStart": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; ignore_errors=no ; start_time=[Sun 2025-09-07 16:09:43 UTC] ; stop_time=[n/a] ; pid=16618 ; code=(null) ; status=0/0 ***", "ExecStartEx": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; flags= ; start_time=[Sun 2025-09-07 16:09:43 UTC] ; stop_time=[n/a] ; pid=16618 ; code=(null) ; status=0/0 ***", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/etc/systemd/system/red-legion-bot.service", "FreezerState": "running", "GID": "0", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "red-legion-bot.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-09-07 16:09:43 UTC", "InactiveExitTimestampMonotonic": "3850363229", "InvocationID": "940d226321fd485bbef92c0c1a271149", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "2190", "LimitNPROCSoft": "2190", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "2190", "LimitSIGPENDINGSoft": "2190", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "16618", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "40460288", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "red-legion-bot.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice -.mount", "RequiresMountsFor": "/app", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "10s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "journal", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-09-07 16:09:43 UTC", "StateChangeTimestampMonotonic": "3850363229", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "1", "TasksMax": "657", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "0", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "root", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0", "WorkingDirectory": "/app"***
2025-09-07T16:09:48.2617354Z 
2025-09-07T16:09:48.2617838Z TASK [Show service status] *****************************************************
2025-09-07T16:09:48.2872037Z ok: [34.30.73.146] => ***
2025-09-07T16:09:48.2872840Z     "msg": "Service status: active"
2025-09-07T16:09:48.2873341Z ***
2025-09-07T16:09:48.2873842Z 
2025-09-07T16:09:48.2874183Z TASK [Check service logs if failed] ********************************************
2025-09-07T16:09:48.3096949Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "not ansible_check_mode and service_status is defined and service_status.status.ActiveState != 'active'", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:48.3097867Z 
2025-09-07T16:09:48.3098206Z TASK [Fail with service logs if service not active] ****************************
2025-09-07T16:09:48.3310141Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "not ansible_check_mode and service_status is defined and service_status.status.ActiveState != 'active'", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:48.3311076Z 
2025-09-07T16:09:48.3311389Z TASK [Verify bot is running] ***************************************************
2025-09-07T16:09:48.3566998Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/verify_bot.yml for 34.30.73.146
2025-09-07T16:09:48.3567860Z 
2025-09-07T16:09:48.3568276Z TASK [Check if bot PID file exists] ********************************************
2025-09-07T16:09:49.7370812Z ok: [34.30.73.146] => ***"changed": false, "stat": ***"exists": false***
2025-09-07T16:09:49.7371564Z 
2025-09-07T16:09:49.7372099Z TASK [Verify bot process is running] *******************************************
2025-09-07T16:09:49.7599219Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.7600215Z 
2025-09-07T16:09:49.7600531Z TASK [Check bot log for errors] ************************************************
2025-09-07T16:09:49.7815520Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.7816823Z 
2025-09-07T16:09:49.7817150Z TASK [Display recent log entries] **********************************************
2025-09-07T16:09:49.8025524Z skipping: [34.30.73.146] => ***"false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode"***
2025-09-07T16:09:49.8026284Z 
2025-09-07T16:09:49.8026627Z TASK [Check for error patterns in log] *****************************************
2025-09-07T16:09:49.8238541Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.8239535Z 
2025-09-07T16:09:49.8239837Z TASK [Read PID from file] ******************************************************
2025-09-07T16:09:49.8481663Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.8482999Z 
2025-09-07T16:09:49.8483370Z TASK [Report successful deployment] ********************************************
2025-09-07T16:09:49.8805013Z skipping: [34.30.73.146] => ***"false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and process_check is defined and (process_check.rc | default(0)) == 0 and pid_content is defined and not ansible_check_mode"***
2025-09-07T16:09:49.8806078Z 
2025-09-07T16:09:49.8806397Z TASK [Clean up temporary files] ************************************************
2025-09-07T16:09:54.1825938Z changed: [34.30.73.146] => (item=/app/.git) => ***"ansible_loop_var": "item", "changed": true, "item": "/app/.git", "path": "/app/.git", "state": "absent"***
2025-09-07T16:09:54.1827611Z changed: [34.30.73.146] => (item=/app/ansible) => ***"ansible_loop_var": "item", "changed": true, "item": "/app/ansible", "path": "/app/ansible", "state": "absent"***
2025-09-07T16:09:54.1829591Z changed: [34.30.73.146] => (item=/app/tests) => ***"ansible_loop_var": "item", "changed": true, "item": "/app/tests", "path": "/app/tests", "state": "absent"***
2025-09-07T16:09:54.1830438Z 
2025-09-07T16:09:54.1830906Z RUNNING HANDLER [reload systemd] ***********************************************
2025-09-07T16:09:56.2626633Z ok: [34.30.73.146] => ***"changed": false, "name": null, "status": ***
2025-09-07T16:09:56.2627371Z 
2025-09-07T16:09:56.2627702Z PLAY RECAP *********************************************************************
2025-09-07T16:09:56.2628607Z 34.30.73.146               : ok=43   changed=16   unreachable=0    failed=0    skipped=17   rescued=0    ignored=3   
2025-09-07T16:09:56.2629177Z 
2025-09-07T16:09:56.3196153Z === Ansible deployment completed ===
2025-09-07T16:09:56.3196932Z === Waiting for bot to stabilize ===
2025-09-07T16:10:06.3219598Z === Bot startup wait completed ===
