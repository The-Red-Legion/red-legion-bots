2025-09-07T15:56:46.5367807Z Current runner version: '2.328.0'
2025-09-07T15:56:46.5395571Z ##[group]Runner Image Provisioner
2025-09-07T15:56:46.5397346Z Hosted Compute Agent
2025-09-07T15:56:46.5398731Z Version: 20250829.383
2025-09-07T15:56:46.5400165Z Commit: 27cb235aab5b0e52e153a26cd86b4742e89dac5d
2025-09-07T15:56:46.5401691Z Build Date: 2025-08-29T13:48:48Z
2025-09-07T15:56:46.5403467Z ##[endgroup]
2025-09-07T15:56:46.5404775Z ##[group]Operating System
2025-09-07T15:56:46.5406156Z Ubuntu
2025-09-07T15:56:46.5407413Z 24.04.3
2025-09-07T15:56:46.5408736Z LTS
2025-09-07T15:56:46.5409971Z ##[endgroup]
2025-09-07T15:56:46.5411301Z ##[group]Runner Image
2025-09-07T15:56:46.5412791Z Image: ubuntu-24.04
2025-09-07T15:56:46.5414182Z Version: 20250831.1.0
2025-09-07T15:56:46.5416122Z Included Software: https://github.com/actions/runner-images/blob/ubuntu24/20250831.1/images/ubuntu/Ubuntu2404-Readme.md
2025-09-07T15:56:46.5418610Z Image Release: https://github.com/actions/runner-images/releases/tag/ubuntu24%2F20250831.1
2025-09-07T15:56:46.5420499Z ##[endgroup]
2025-09-07T15:56:46.5423586Z ##[group]GITHUB_TOKEN Permissions
2025-09-07T15:56:46.5426357Z Actions: read
2025-09-07T15:56:46.5427765Z Checks: read
2025-09-07T15:56:46.5429029Z Contents: write
2025-09-07T15:56:46.5430343Z Issues: write
2025-09-07T15:56:46.5431658Z Metadata: read
2025-09-07T15:56:46.5433844Z PullRequests: write
2025-09-07T15:56:46.5435314Z ##[endgroup]
2025-09-07T15:56:46.5438348Z Secret source: Actions
2025-09-07T15:56:46.5440195Z Prepare workflow directory
2025-09-07T15:56:46.6081782Z Prepare all required actions
2025-09-07T15:56:46.6120284Z Getting action download info
2025-09-07T15:56:47.0564205Z Download action repository 'actions/checkout@v4' (SHA:08eba0b27e820071cde6df949e0beb9ba4906955)
2025-09-07T15:56:47.2185431Z Download action repository 'google-github-actions/auth@v2' (SHA:c200f3691d83b41bf9bbd8638997a462592937ed)
2025-09-07T15:56:47.7208106Z Download action repository 'actions/setup-python@v4' (SHA:7f4fc3e22c37d6ff65e88745f38bd3157c663f7c)
2025-09-07T15:56:47.9746885Z Complete job name: deploy-arccorp-compute
2025-09-07T15:56:48.0659130Z ##[group]Run actions/checkout@v4
2025-09-07T15:56:48.0661353Z with:
2025-09-07T15:56:48.0663228Z   repository: The-Red-Legion/red-legion-bots
2025-09-07T15:56:48.0665521Z   token: ***
2025-09-07T15:56:48.0667135Z   ssh-strict: true
2025-09-07T15:56:48.0668800Z   ssh-user: git
2025-09-07T15:56:48.0670483Z   persist-credentials: true
2025-09-07T15:56:48.0672278Z   clean: true
2025-09-07T15:56:48.0674158Z   sparse-checkout-cone-mode: true
2025-09-07T15:56:48.0676018Z   fetch-depth: 1
2025-09-07T15:56:48.0677661Z   fetch-tags: false
2025-09-07T15:56:48.0679332Z   show-progress: true
2025-09-07T15:56:48.0681022Z   lfs: false
2025-09-07T15:56:48.0682771Z   submodules: false
2025-09-07T15:56:48.0684462Z   set-safe-directory: true
2025-09-07T15:56:48.0686447Z env:
2025-09-07T15:56:48.0688990Z   DATABASE_URL: ***
2025-09-07T15:56:48.0690651Z ##[endgroup]
2025-09-07T15:56:48.1806734Z Syncing repository: The-Red-Legion/red-legion-bots
2025-09-07T15:56:48.1810842Z ##[group]Getting Git version info
2025-09-07T15:56:48.1813595Z Working directory is '/home/runner/work/red-legion-bots/red-legion-bots'
2025-09-07T15:56:48.1817066Z [command]/usr/bin/git version
2025-09-07T15:56:48.1885509Z git version 2.51.0
2025-09-07T15:56:48.1913427Z ##[endgroup]
2025-09-07T15:56:48.1925344Z Temporarily overriding HOME='/home/runner/work/_temp/601d863d-08b0-4945-bf2c-d6eb39ef585a' before making global git config changes
2025-09-07T15:56:48.1929784Z Adding repository directory to the temporary git global config as a safe directory
2025-09-07T15:56:48.1933453Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/red-legion-bots/red-legion-bots
2025-09-07T15:56:48.1965106Z Deleting the contents of '/home/runner/work/red-legion-bots/red-legion-bots'
2025-09-07T15:56:48.1969254Z ##[group]Initializing the repository
2025-09-07T15:56:48.1972906Z [command]/usr/bin/git init /home/runner/work/red-legion-bots/red-legion-bots
2025-09-07T15:56:48.2088035Z hint: Using 'master' as the name for the initial branch. This default branch name
2025-09-07T15:56:48.2092027Z hint: is subject to change. To configure the initial branch name to use in all
2025-09-07T15:56:48.2095124Z hint: of your new repositories, which will suppress this warning, call:
2025-09-07T15:56:48.2098071Z hint:
2025-09-07T15:56:48.2099906Z hint: 	git config --global init.defaultBranch <name>
2025-09-07T15:56:48.2102709Z hint:
2025-09-07T15:56:48.2104768Z hint: Names commonly chosen instead of 'master' are 'main', 'trunk' and
2025-09-07T15:56:48.2107586Z hint: 'development'. The just-created branch can be renamed via this command:
2025-09-07T15:56:48.2110001Z hint:
2025-09-07T15:56:48.2111627Z hint: 	git branch -m <name>
2025-09-07T15:56:48.2113598Z hint:
2025-09-07T15:56:48.2115734Z hint: Disable this message with "git config set advice.defaultBranchName false"
2025-09-07T15:56:48.2118897Z Initialized empty Git repository in /home/runner/work/red-legion-bots/red-legion-bots/.git/
2025-09-07T15:56:48.2124291Z [command]/usr/bin/git remote add origin https://github.com/The-Red-Legion/red-legion-bots
2025-09-07T15:56:48.2144495Z ##[endgroup]
2025-09-07T15:56:48.2147649Z ##[group]Disabling automatic garbage collection
2025-09-07T15:56:48.2149883Z [command]/usr/bin/git config --local gc.auto 0
2025-09-07T15:56:48.2185854Z ##[endgroup]
2025-09-07T15:56:48.2189593Z ##[group]Setting up auth
2025-09-07T15:56:48.2191938Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-09-07T15:56:48.2217219Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-09-07T15:56:48.2559075Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-09-07T15:56:48.2589703Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-09-07T15:56:48.2834813Z [command]/usr/bin/git config --local http.https://github.com/.extraheader AUTHORIZATION: basic ***
2025-09-07T15:56:48.2871858Z ##[endgroup]
2025-09-07T15:56:48.2876868Z ##[group]Fetching the repository
2025-09-07T15:56:48.2883667Z [command]/usr/bin/git -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +df032f364d2d8996b8b933ee779a77b352811b2c:refs/remotes/pull/50/merge
2025-09-07T15:56:48.7295450Z From https://github.com/The-Red-Legion/red-legion-bots
2025-09-07T15:56:48.7298819Z  * [new ref]         df032f364d2d8996b8b933ee779a77b352811b2c -> pull/50/merge
2025-09-07T15:56:48.7328515Z ##[endgroup]
2025-09-07T15:56:48.7331224Z ##[group]Determining the checkout info
2025-09-07T15:56:48.7335177Z ##[endgroup]
2025-09-07T15:56:48.7337048Z [command]/usr/bin/git sparse-checkout disable
2025-09-07T15:56:48.7375730Z [command]/usr/bin/git config --local --unset-all extensions.worktreeConfig
2025-09-07T15:56:48.7406442Z ##[group]Checking out the ref
2025-09-07T15:56:48.7408872Z [command]/usr/bin/git checkout --progress --force refs/remotes/pull/50/merge
2025-09-07T15:56:48.7513229Z Note: switching to 'refs/remotes/pull/50/merge'.
2025-09-07T15:56:48.7515462Z 
2025-09-07T15:56:48.7516718Z You are in 'detached HEAD' state. You can look around, make experimental
2025-09-07T15:56:48.7520258Z changes and commit them, and you can discard any commits you make in this
2025-09-07T15:56:48.7523529Z state without impacting any branches by switching back to a branch.
2025-09-07T15:56:48.7525118Z 
2025-09-07T15:56:48.7526327Z If you want to create a new branch to retain commits you create, you may
2025-09-07T15:56:48.7528921Z do so (now or later) by using -c with the switch command. Example:
2025-09-07T15:56:48.7530364Z 
2025-09-07T15:56:48.7531201Z   git switch -c <new-branch-name>
2025-09-07T15:56:48.7532483Z 
2025-09-07T15:56:48.7533335Z Or undo this operation with:
2025-09-07T15:56:48.7534677Z 
2025-09-07T15:56:48.7535467Z   git switch -
2025-09-07T15:56:48.7536354Z 
2025-09-07T15:56:48.7537625Z Turn off this advice by setting config variable advice.detachedHead to false
2025-09-07T15:56:48.7539220Z 
2025-09-07T15:56:48.7540996Z HEAD is now at df032f3 Merge ed0d12a9e1e0a26adfe71f703c3d2e7457edbc4c into e73349f7c689a84198d9aa7d0e5c0ffc64ae0e42
2025-09-07T15:56:48.7547097Z ##[endgroup]
2025-09-07T15:56:48.7556268Z [command]/usr/bin/git log -1 --format=%H
2025-09-07T15:56:48.7578450Z df032f364d2d8996b8b933ee779a77b352811b2c
2025-09-07T15:56:48.7976482Z ##[group]Run google-github-actions/auth@v2
2025-09-07T15:56:48.7978532Z with:
2025-09-07T15:56:48.8014638Z   credentials_json: ***

2025-09-07T15:56:48.8016442Z   create_credentials_file: true
2025-09-07T15:56:48.8018323Z   export_environment_variables: true
2025-09-07T15:56:48.8020259Z   universe: googleapis.com
2025-09-07T15:56:48.8022085Z   cleanup_credentials: true
2025-09-07T15:56:48.8024033Z   access_token_lifetime: 3600s
2025-09-07T15:56:48.8026259Z   access_token_scopes: https://www.googleapis.com/auth/cloud-platform
2025-09-07T15:56:48.8028607Z   id_token_include_email: false
2025-09-07T15:56:48.8030360Z env:
2025-09-07T15:56:48.8032914Z   DATABASE_URL: ***
2025-09-07T15:56:48.8034572Z ##[endgroup]
2025-09-07T15:56:48.9056087Z Created credentials file at "/home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json"
2025-09-07T15:56:48.9241000Z ##[group]Run echo "🔗 Testing GCloud SSH connection to arccorp-compute..."
2025-09-07T15:56:48.9244121Z [36;1mecho "🔗 Testing GCloud SSH connection to arccorp-compute..."[0m
2025-09-07T15:56:48.9248203Z [36;1mif gcloud compute ssh arccorp-compute --zone=us-central1-a --project=rl-prod-471116 --command="echo 'GCloud SSH connection test successful'" --ssh-flag="-o ConnectTimeout=30"; then[0m
2025-09-07T15:56:48.9251990Z [36;1m  echo "✅ GCloud SSH connection successful"[0m
2025-09-07T15:56:48.9254213Z [36;1melse[0m
2025-09-07T15:56:48.9256072Z [36;1m  echo "⚠️ GCloud SSH test failed - continuing anyway"[0m
2025-09-07T15:56:48.9258235Z [36;1mfi[0m
2025-09-07T15:56:48.9259799Z [36;1m[0m
2025-09-07T15:56:48.9261432Z [36;1m# Get current VM IP for Ansible[0m
2025-09-07T15:56:48.9263699Z [36;1mecho "🔍 Getting current VM IP address..."[0m
2025-09-07T15:56:48.9267577Z [36;1mVM_IP=$(gcloud compute instances describe arccorp-compute --zone=us-central1-a --project=rl-prod-471116 --format="get(networkInterfaces[0].accessConfigs[0].natIP)" || echo "")[0m
2025-09-07T15:56:48.9271207Z [36;1mif [ -z "$VM_IP" ]; then[0m
2025-09-07T15:56:48.9273531Z [36;1m  echo "❌ Could not get VM IP address, using fallback"[0m
2025-09-07T15:56:48.9275710Z [36;1m  VM_IP="34.30.73.146"[0m
2025-09-07T15:56:48.9277478Z [36;1mfi[0m
2025-09-07T15:56:48.9279129Z [36;1mecho "📍 Current VM IP: $VM_IP"[0m
2025-09-07T15:56:48.9281161Z [36;1mecho "vm_ip=$VM_IP" >> $GITHUB_OUTPUT[0m
2025-09-07T15:56:48.9342012Z shell: /usr/bin/bash -e ***0***
2025-09-07T15:56:48.9344116Z env:
2025-09-07T15:56:48.9346629Z   DATABASE_URL: ***
2025-09-07T15:56:48.9349389Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:56:48.9354039Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:56:48.9358797Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:56:48.9361849Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:56:48.9364038Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:56:48.9365952Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:56:48.9367816Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:56:48.9369684Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:56:48.9371578Z ##[endgroup]
2025-09-07T15:56:48.9462883Z 🔗 Testing GCloud SSH connection to arccorp-compute...
2025-09-07T15:56:59.6800515Z WARNING: The private SSH key file for gcloud does not exist.
2025-09-07T15:56:59.6803563Z WARNING: The public SSH key file for gcloud does not exist.
2025-09-07T15:56:59.6805248Z WARNING: You do not have an SSH key for gcloud.
2025-09-07T15:56:59.6806580Z WARNING: SSH keygen will be executed to generate a key.
2025-09-07T15:56:59.6807772Z This tool needs to create the directory [/home/runner/.ssh] before being able to
2025-09-07T15:56:59.6808899Z  generate SSH keys.
2025-09-07T15:56:59.6809385Z 
2025-09-07T15:56:59.6809792Z Do you want to continue (Y/n)?  
2025-09-07T15:57:00.7956294Z Generating public/private rsa key pair.
2025-09-07T15:57:00.7957515Z Your identification has been saved in /home/runner/.ssh/google_compute_engine
2025-09-07T15:57:00.7958553Z Your public key has been saved in /home/runner/.ssh/google_compute_engine.pub
2025-09-07T15:57:00.7959213Z The key fingerprint is:
2025-09-07T15:57:00.7959870Z SHA256:ZiDbH89Yi3Y1UVS2w9ph8Uew+3O4EV3EKV1M8wn+510 runner@pkrvm7jw40e0xgp
2025-09-07T15:57:00.7960546Z The key's randomart image is:
2025-09-07T15:57:00.7961041Z +---[RSA 3072]----+
2025-09-07T15:57:00.7961567Z |             o=OX|
2025-09-07T15:57:00.7961977Z |            .ooBX|
2025-09-07T15:57:00.7962732Z |    . .     ..oB=|
2025-09-07T15:57:00.7963389Z |     + .     .=o=|
2025-09-07T15:57:00.7963858Z |    . . S . o.ooE|
2025-09-07T15:57:00.7964284Z |       + B o . =+|
2025-09-07T15:57:00.7964691Z |        = =   o.=|
2025-09-07T15:57:00.7965114Z |       . .     oo|
2025-09-07T15:57:00.7965803Z |              .  |
2025-09-07T15:57:00.7966247Z +----[SHA256]-----+
2025-09-07T15:57:01.2605399Z Updating project ssh metadata...
2025-09-07T15:57:11.2740866Z ..................................................Updated [https://www.googleapis.com/compute/v1/projects/rl-prod-471116].
2025-09-07T15:57:11.4988165Z .done.
2025-09-07T15:57:11.6670228Z Waiting for SSH key to propagate.
2025-09-07T15:57:12.0246079Z Warning: Permanently added 'compute.4395654183015020126' (ED25519) to the list of known hosts.
2025-09-07T15:57:14.0687373Z GCloud SSH connection test successful
2025-09-07T15:57:14.1804926Z ✅ GCloud SSH connection successful
2025-09-07T15:57:14.1806011Z 🔍 Getting current VM IP address...
2025-09-07T15:57:15.6167187Z 📍 Current VM IP: 34.30.73.146
2025-09-07T15:57:15.6252888Z ##[group]Run mkdir -p ~/.ssh
2025-09-07T15:57:15.6253483Z [36;1mmkdir -p ~/.ssh[0m
2025-09-07T15:57:15.6254010Z [36;1mecho "***[0m
2025-09-07T15:57:15.6254651Z [36;1m***[0m
2025-09-07T15:57:15.6255226Z [36;1m***[0m
2025-09-07T15:57:15.6255776Z [36;1m***[0m
2025-09-07T15:57:15.6256320Z [36;1m***[0m
2025-09-07T15:57:15.6256854Z [36;1m***[0m
2025-09-07T15:57:15.6257446Z [36;1m***[0m
2025-09-07T15:57:15.6258022Z [36;1m***[0m
2025-09-07T15:57:15.6258603Z [36;1m***[0m
2025-09-07T15:57:15.6259167Z [36;1m***[0m
2025-09-07T15:57:15.6259714Z [36;1m***[0m
2025-09-07T15:57:15.6260273Z [36;1m***[0m
2025-09-07T15:57:15.6260816Z [36;1m***[0m
2025-09-07T15:57:15.6261392Z [36;1m***[0m
2025-09-07T15:57:15.6261954Z [36;1m***[0m
2025-09-07T15:57:15.6262673Z [36;1m***[0m
2025-09-07T15:57:15.6263247Z [36;1m***[0m
2025-09-07T15:57:15.6263806Z [36;1m***[0m
2025-09-07T15:57:15.6264361Z [36;1m***[0m
2025-09-07T15:57:15.6264887Z [36;1m***[0m
2025-09-07T15:57:15.6265472Z [36;1m***[0m
2025-09-07T15:57:15.6266021Z [36;1m***[0m
2025-09-07T15:57:15.6266578Z [36;1m***[0m
2025-09-07T15:57:15.6267128Z [36;1m***[0m
2025-09-07T15:57:15.6267691Z [36;1m***[0m
2025-09-07T15:57:15.6268241Z [36;1m***[0m
2025-09-07T15:57:15.6268796Z [36;1m***[0m
2025-09-07T15:57:15.6269366Z [36;1m***[0m
2025-09-07T15:57:15.6269955Z [36;1m***[0m
2025-09-07T15:57:15.6270497Z [36;1m***[0m
2025-09-07T15:57:15.6271054Z [36;1m***[0m
2025-09-07T15:57:15.6271588Z [36;1m***[0m
2025-09-07T15:57:15.6272177Z [36;1m***[0m
2025-09-07T15:57:15.6272874Z [36;1m***[0m
2025-09-07T15:57:15.6273423Z [36;1m***[0m
2025-09-07T15:57:15.6273965Z [36;1m***[0m
2025-09-07T15:57:15.6274506Z [36;1m***[0m
2025-09-07T15:57:15.6275052Z [36;1m***[0m
2025-09-07T15:57:15.6275595Z [36;1m***[0m
2025-09-07T15:57:15.6276128Z [36;1m***[0m
2025-09-07T15:57:15.6276907Z [36;1m***[0m
2025-09-07T15:57:15.6277443Z [36;1m***[0m
2025-09-07T15:57:15.6277983Z [36;1m***[0m
2025-09-07T15:57:15.6278533Z [36;1m***[0m
2025-09-07T15:57:15.6279110Z [36;1m***[0m
2025-09-07T15:57:15.6279657Z [36;1m***[0m
2025-09-07T15:57:15.6280226Z [36;1m***[0m
2025-09-07T15:57:15.6280776Z [36;1m***[0m
2025-09-07T15:57:15.6281578Z [36;1m***[0m
2025-09-07T15:57:15.6282707Z [36;1m***[0m
2025-09-07T15:57:15.6299744Z [36;1m***" > ~/.ssh/id_rsa[0m
2025-09-07T15:57:15.6300275Z [36;1mchmod 600 ~/.ssh/id_rsa[0m
2025-09-07T15:57:15.6300858Z [36;1m# Add host key for the current IP[0m
2025-09-07T15:57:15.6301473Z [36;1mssh-keyscan -H 34.30.73.146 >> ~/.ssh/known_hosts || true[0m
2025-09-07T15:57:15.6302168Z [36;1mecho "🔍 Testing SSH connection for Ansible to 34.30.73.146..."[0m
2025-09-07T15:57:15.6303513Z [36;1mssh -o StrictHostKeyChecking=no -o ConnectTimeout=30 ubuntu@34.30.73.146 "echo 'Ansible SSH connection test successful'" || echo "SSH test failed - continuing anyway"[0m
2025-09-07T15:57:15.6336039Z shell: /usr/bin/bash -e ***0***
2025-09-07T15:57:15.6336513Z env:
2025-09-07T15:57:15.6337237Z   DATABASE_URL: ***
2025-09-07T15:57:15.6337999Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:15.6339048Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:15.6340012Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:15.6340785Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:57:15.6341318Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:57:15.6341800Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:15.6342265Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:57:15.6342934Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:15.6343428Z ##[endgroup]
2025-09-07T15:57:15.8236998Z # 34.30.73.146:22 SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.13
2025-09-07T15:57:15.8745749Z # 34.30.73.146:22 SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.13
2025-09-07T15:57:16.0914730Z # 34.30.73.146:22 SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.13
2025-09-07T15:57:16.2973824Z # 34.30.73.146:22 SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.13
2025-09-07T15:57:16.5015335Z # 34.30.73.146:22 SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.13
2025-09-07T15:57:16.5564625Z 🔍 Testing SSH connection for Ansible to 34.30.73.146...
2025-09-07T15:57:17.5980913Z Ansible SSH connection test successful
2025-09-07T15:57:17.6029413Z ##[group]Run # Create a temporary inventory file with the current IP
2025-09-07T15:57:17.6030156Z [36;1m# Create a temporary inventory file with the current IP[0m
2025-09-07T15:57:17.6030735Z [36;1mmkdir -p /tmp/ansible[0m
2025-09-07T15:57:17.6031228Z [36;1mcat > /tmp/ansible/inventory.ini << EOF[0m
2025-09-07T15:57:17.6031739Z [36;1m[arccorp_compute][0m
2025-09-07T15:57:17.6032600Z [36;1m34.30.73.146 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_rsa[0m
2025-09-07T15:57:17.6033221Z [36;1m[0m
2025-09-07T15:57:17.6033628Z [36;1m[arccorp_compute:vars][0m
2025-09-07T15:57:17.6034131Z [36;1mansible_python_interpreter=/usr/bin/python3[0m
2025-09-07T15:57:17.6034639Z [36;1mEOF[0m
2025-09-07T15:57:17.6035082Z [36;1mecho "📋 Dynamic inventory file created:"[0m
2025-09-07T15:57:17.6035612Z [36;1mcat /tmp/ansible/inventory.ini[0m
2025-09-07T15:57:17.6065445Z shell: /usr/bin/bash -e ***0***
2025-09-07T15:57:17.6065899Z env:
2025-09-07T15:57:17.6066632Z   DATABASE_URL: ***
2025-09-07T15:57:17.6067378Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.6068444Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.6069436Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.6070157Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6070833Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6071303Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6071764Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6072222Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6072990Z ##[endgroup]
2025-09-07T15:57:17.6145292Z 📋 Dynamic inventory file created:
2025-09-07T15:57:17.6153658Z [arccorp_compute]
2025-09-07T15:57:17.6154489Z 34.30.73.146 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_rsa
2025-09-07T15:57:17.6154914Z 
2025-09-07T15:57:17.6155108Z [arccorp_compute:vars]
2025-09-07T15:57:17.6155578Z ansible_python_interpreter=/usr/bin/python3
2025-09-07T15:57:17.6238082Z ##[group]Run actions/setup-python@v4
2025-09-07T15:57:17.6238588Z with:
2025-09-07T15:57:17.6238983Z   python-version: 3.9
2025-09-07T15:57:17.6239414Z   check-latest: false
2025-09-07T15:57:17.6239915Z   token: ***
2025-09-07T15:57:17.6240331Z   update-environment: true
2025-09-07T15:57:17.6240785Z   allow-prereleases: false
2025-09-07T15:57:17.6241221Z env:
2025-09-07T15:57:17.6241909Z   DATABASE_URL: ***
2025-09-07T15:57:17.6242865Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.6243917Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.6244876Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.6245585Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6246093Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6246605Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6247069Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6247533Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.6248010Z ##[endgroup]
2025-09-07T15:57:17.7877599Z ##[group]Installed versions
2025-09-07T15:57:17.7989356Z Successfully set up CPython (3.9.23)
2025-09-07T15:57:17.7991061Z ##[endgroup]
2025-09-07T15:57:17.8176334Z ##[group]Run google-github-actions/auth@v2
2025-09-07T15:57:17.8176878Z with:
2025-09-07T15:57:17.8186687Z   credentials_json: ***

2025-09-07T15:57:17.8187134Z   create_credentials_file: true
2025-09-07T15:57:17.8187605Z   export_environment_variables: true
2025-09-07T15:57:17.8188101Z   universe: googleapis.com
2025-09-07T15:57:17.8188542Z   cleanup_credentials: true
2025-09-07T15:57:17.8188983Z   access_token_lifetime: 3600s
2025-09-07T15:57:17.8189546Z   access_token_scopes: https://www.googleapis.com/auth/cloud-platform
2025-09-07T15:57:17.8190140Z   id_token_include_email: false
2025-09-07T15:57:17.8190569Z env:
2025-09-07T15:57:17.8191234Z   DATABASE_URL: ***
2025-09-07T15:57:17.8191964Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.8193251Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.8194254Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-72c2f76e0034e39b.json
2025-09-07T15:57:17.8194957Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:57:17.8195450Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:57:17.8195928Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.8196385Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:57:17.8196841Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.8197395Z   pythonLocation: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.8198061Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib/pkgconfig
2025-09-07T15:57:17.8198697Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.8199294Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.8199880Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.8200470Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib
2025-09-07T15:57:17.8201215Z ##[endgroup]
2025-09-07T15:57:17.9186163Z Created credentials file at "/home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json"
2025-09-07T15:57:17.9304139Z ##[group]Run python -m pip install --upgrade pip
2025-09-07T15:57:17.9304781Z [36;1mpython -m pip install --upgrade pip[0m
2025-09-07T15:57:17.9305292Z [36;1mpip install ansible[0m
2025-09-07T15:57:17.9455099Z shell: /usr/bin/bash -e ***0***
2025-09-07T15:57:17.9455601Z env:
2025-09-07T15:57:17.9456310Z   DATABASE_URL: ***
2025-09-07T15:57:17.9457070Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:17.9458119Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:17.9459098Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:17.9459817Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:57:17.9460355Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:57:17.9460832Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.9461362Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:57:17.9461827Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:17.9462519Z   pythonLocation: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.9463203Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib/pkgconfig
2025-09-07T15:57:17.9463853Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.9464463Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.9465056Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:17.9465658Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib
2025-09-07T15:57:17.9466196Z ##[endgroup]
2025-09-07T15:57:23.0118218Z Requirement already satisfied: pip in /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages (25.2)
2025-09-07T15:57:24.0415907Z Collecting ansible
2025-09-07T15:57:24.0552784Z   Downloading ansible-8.7.0-py3-none-any.whl.metadata (7.9 kB)
2025-09-07T15:57:24.1186920Z Collecting ansible-core~=2.15.7 (from ansible)
2025-09-07T15:57:24.1234416Z   Downloading ansible_core-2.15.13-py3-none-any.whl.metadata (7.0 kB)
2025-09-07T15:57:24.1416297Z Collecting jinja2>=3.0.0 (from ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.1451684Z   Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
2025-09-07T15:57:24.1864317Z Collecting PyYAML>=5.1 (from ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.1908534Z   Downloading PyYAML-6.0.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.1 kB)
2025-09-07T15:57:24.4026334Z Collecting cryptography (from ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.4062969Z   Downloading cryptography-45.0.7-cp37-abi3-manylinux_2_34_x86_64.whl.metadata (5.7 kB)
2025-09-07T15:57:24.4326640Z Collecting packaging (from ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.4360695Z   Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
2025-09-07T15:57:24.4513947Z Collecting resolvelib<1.1.0,>=0.5.3 (from ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.4550027Z   Downloading resolvelib-1.0.1-py2.py3-none-any.whl.metadata (4.0 kB)
2025-09-07T15:57:24.4825059Z Collecting importlib-resources<5.1,>=5.0 (from ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.4866126Z   Downloading importlib_resources-5.0.7-py3-none-any.whl.metadata (2.8 kB)
2025-09-07T15:57:24.5476223Z Collecting MarkupSafe>=2.0 (from jinja2>=3.0.0->ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.5511167Z   Downloading MarkupSafe-3.0.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.0 kB)
2025-09-07T15:57:24.6752031Z Collecting cffi>=1.14 (from cryptography->ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.6791342Z   Downloading cffi-1.17.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.5 kB)
2025-09-07T15:57:24.6898644Z Collecting pycparser (from cffi>=1.14->cryptography->ansible-core~=2.15.7->ansible)
2025-09-07T15:57:24.6931858Z   Downloading pycparser-2.22-py3-none-any.whl.metadata (943 bytes)
2025-09-07T15:57:24.7007782Z Downloading ansible-8.7.0-py3-none-any.whl (48.4 MB)
2025-09-07T15:57:25.9661456Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 48.4/48.4 MB 38.2 MB/s  0:00:01
2025-09-07T15:57:25.9711392Z Downloading ansible_core-2.15.13-py3-none-any.whl (2.3 MB)
2025-09-07T15:57:26.0185703Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.3/2.3 MB 47.9 MB/s  0:00:00
2025-09-07T15:57:26.0235780Z Downloading importlib_resources-5.0.7-py3-none-any.whl (24 kB)
2025-09-07T15:57:26.0295799Z Downloading resolvelib-1.0.1-py2.py3-none-any.whl (17 kB)
2025-09-07T15:57:26.0417847Z Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
2025-09-07T15:57:26.0521369Z Downloading MarkupSafe-3.0.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (20 kB)
2025-09-07T15:57:26.0581384Z Downloading PyYAML-6.0.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (737 kB)
2025-09-07T15:57:26.0981305Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 737.4/737.4 kB 15.6 MB/s  0:00:00
2025-09-07T15:57:26.1065315Z Downloading cryptography-45.0.7-cp37-abi3-manylinux_2_34_x86_64.whl (4.4 MB)
2025-09-07T15:57:26.2010633Z    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.4/4.4 MB 50.0 MB/s  0:00:00
2025-09-07T15:57:26.2049290Z Downloading cffi-1.17.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (445 kB)
2025-09-07T15:57:26.2173513Z Downloading packaging-25.0-py3-none-any.whl (66 kB)
2025-09-07T15:57:26.2236828Z Downloading pycparser-2.22-py3-none-any.whl (117 kB)
2025-09-07T15:57:26.6029175Z Installing collected packages: resolvelib, PyYAML, pycparser, packaging, MarkupSafe, importlib-resources, jinja2, cffi, cryptography, ansible-core, ansible
2025-09-07T15:57:52.0841049Z 
2025-09-07T15:57:52.0874010Z Successfully installed MarkupSafe-3.0.2 PyYAML-6.0.2 ansible-8.7.0 ansible-core-2.15.13 cffi-1.17.1 cryptography-45.0.7 importlib-resources-5.0.7 jinja2-3.1.6 packaging-25.0 pycparser-2.22 resolvelib-1.0.1
2025-09-07T15:57:52.1784604Z ##[group]Run echo "=== Starting Ansible deployment ==="
2025-09-07T15:57:52.1785285Z [36;1mecho "=== Starting Ansible deployment ==="[0m
2025-09-07T15:57:52.1785808Z [36;1m[0m
2025-09-07T15:57:52.1786242Z [36;1m# Set environment variables for Ansible[0m
2025-09-07T15:57:52.1787038Z [36;1mexport DISCORD_TOKEN=***[0m
2025-09-07T15:57:52.1787582Z [36;1mexport TEXT_CHANNEL_ID=***[0m
2025-09-07T15:57:52.1788382Z [36;1mexport DATABASE_URL=***[0m
2025-09-07T15:57:52.1788847Z [36;1m[0m
2025-09-07T15:57:52.1789298Z [36;1m# Run Ansible playbook with dynamic inventory[0m
2025-09-07T15:57:52.1790096Z [36;1mDISCORD_TOKEN=*** \[0m
2025-09-07T15:57:52.1790616Z [36;1mTEXT_CHANNEL_ID=*** \[0m
2025-09-07T15:57:52.1791368Z [36;1mDATABASE_URL=*** \[0m
2025-09-07T15:57:52.1791978Z [36;1mansible-playbook ansible/deploy.yml -i /tmp/ansible/inventory.ini -v[0m
2025-09-07T15:57:52.1792851Z [36;1m[0m
2025-09-07T15:57:52.1793336Z [36;1mecho "=== Ansible deployment completed ==="[0m
2025-09-07T15:57:52.1793854Z [36;1m[0m
2025-09-07T15:57:52.1794284Z [36;1mecho "=== Waiting for bot to stabilize ==="[0m
2025-09-07T15:57:52.1794786Z [36;1msleep 10[0m
2025-09-07T15:57:52.1795234Z [36;1mecho "=== Bot startup wait completed ==="[0m
2025-09-07T15:57:52.1827202Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail ***0***
2025-09-07T15:57:52.1827801Z env:
2025-09-07T15:57:52.1828465Z   DATABASE_URL: ***
2025-09-07T15:57:52.1829207Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:52.1830258Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:52.1831232Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T15:57:52.1831941Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1832695Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1833409Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1833877Z   GCP_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1834342Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T15:57:52.1834916Z   pythonLocation: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1835595Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib/pkgconfig
2025-09-07T15:57:52.1836264Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1836874Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1837490Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T15:57:52.1838092Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib
2025-09-07T15:57:52.1838630Z ##[endgroup]
2025-09-07T15:57:52.1893300Z === Starting Ansible deployment ===
2025-09-07T15:57:53.2767082Z Using /home/runner/work/red-legion-bots/red-legion-bots/ansible.cfg as config file
2025-09-07T15:57:53.2767864Z 
2025-09-07T15:57:53.2768430Z PLAY [Deploy Participation Bot] ************************************************
2025-09-07T15:57:53.2769141Z 
2025-09-07T15:57:53.2769602Z TASK [Gathering Facts] *********************************************************
2025-09-07T15:57:57.4138677Z ok: [34.30.73.146]
2025-09-07T15:57:57.4139053Z 
2025-09-07T15:57:57.4139450Z TASK [Update apt cache] ********************************************************
2025-09-07T15:58:03.9127245Z changed: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": true, "changed": true***
2025-09-07T15:58:03.9127769Z 
2025-09-07T15:58:03.9128119Z TASK [Install required system packages] ****************************************
2025-09-07T15:58:07.0295900Z ok: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": false, "changed": false***
2025-09-07T15:58:07.0296752Z 
2025-09-07T15:58:07.0297358Z TASK [Try installing postgresql-client] ****************************************
2025-09-07T15:58:09.7204799Z ok: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": false, "changed": false***
2025-09-07T15:58:09.7205452Z 
2025-09-07T15:58:09.7206010Z TASK [Try alternative PostgreSQL client package names] *************************
2025-09-07T15:58:09.7855027Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pg_client_install.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:09.7855935Z 
2025-09-07T15:58:09.7856390Z TASK [Install minimal PostgreSQL development files if others failed] ***********
2025-09-07T15:58:09.8128953Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pg_client_install.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:09.8129636Z 
2025-09-07T15:58:09.8129983Z TASK [Install pip using ensurepip (built into Python 3.4+)] ********************
2025-09-07T15:58:11.4787644Z fatal: [34.30.73.146]: FAILED! => ***"changed": true, "cmd": ["python3", "-m", "ensurepip", "--upgrade"], "delta": "0:00:00.027306", "end": "2025-09-07 15:58:11.291733", "msg": "non-zero return code", "rc": 1, "start": "2025-09-07 15:58:11.264427", "stderr": "/usr/bin/python3: No module named ensurepip", "stderr_lines": ["/usr/bin/python3: No module named ensurepip"], "stdout": "", "stdout_lines": []***
2025-09-07T15:58:11.4789135Z ...ignoring
2025-09-07T15:58:11.4789368Z 
2025-09-07T15:58:11.4789696Z TASK [Install pip via apt if ensurepip failed] *********************************
2025-09-07T15:58:13.9832952Z ok: [34.30.73.146] => ***"cache_update_time": 1757260682, "cache_updated": false, "changed": false***
2025-09-07T15:58:13.9833564Z 
2025-09-07T15:58:13.9833949Z TASK [Download get-pip.py] *****************************************************
2025-09-07T15:58:14.0129515Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "apt_pip_result.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:14.0130197Z 
2025-09-07T15:58:14.0130545Z TASK [Install pip using get-pip.py] ********************************************
2025-09-07T15:58:14.0431010Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "apt_pip_result.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:14.0431839Z 
2025-09-07T15:58:14.0432197Z TASK [Clean up get-pip.py] *****************************************************
2025-09-07T15:58:14.0735098Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "apt_pip_result.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:14.0735933Z 
2025-09-07T15:58:14.0736297Z TASK [Check pip3 command] ******************************************************
2025-09-07T15:58:16.3458174Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["pip3", "--version"], "delta": "0:00:00.728103", "end": "2025-09-07 15:58:16.155588", "msg": "", "rc": 0, "start": "2025-09-07 15:58:15.427485", "stderr": "", "stderr_lines": [], "stdout": "pip 25.2 from /root/.local/lib/python3.10/site-packages/pip (python 3.10)", "stdout_lines": ["pip 25.2 from /root/.local/lib/python3.10/site-packages/pip (python 3.10)"]***
2025-09-07T15:58:16.3459875Z 
2025-09-07T15:58:16.3460194Z TASK [Check python3 -m pip] ****************************************************
2025-09-07T15:58:16.3724166Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pip3_check.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:16.3724844Z 
2025-09-07T15:58:16.3725146Z TASK [Display pip status] ******************************************************
2025-09-07T15:58:16.4021608Z ok: [34.30.73.146] => ***
2025-09-07T15:58:16.4022245Z     "msg": "pip3 command: Available\npython3 -m pip: Available\n"
2025-09-07T15:58:16.4023067Z ***
2025-09-07T15:58:16.4023275Z 
2025-09-07T15:58:16.4023583Z TASK [Fail if no pip method works] *********************************************
2025-09-07T15:58:16.4300737Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pip3_check.failed | default(false)", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:16.4301534Z 
2025-09-07T15:58:16.4301903Z TASK [Upgrade pip to latest version] *******************************************
2025-09-07T15:58:20.1763874Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "-m", "pip", "install", "--user", "--upgrade", "pip"], "delta": "0:00:02.188197", "end": "2025-09-07 15:58:19.974850", "msg": "", "rc": 0, "start": "2025-09-07 15:58:17.786653", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning."], "stdout": "Requirement already satisfied: pip in /root/.local/lib/python3.10/site-packages (25.2)", "stdout_lines": ["Requirement already satisfied: pip in /root/.local/lib/python3.10/site-packages (25.2)"]***
2025-09-07T15:58:20.1768337Z 
2025-09-07T15:58:20.1768684Z TASK [Check if Google Cloud SDK is available] **********************************
2025-09-07T15:58:21.6919518Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["which", "gcloud"], "delta": "0:00:00.006132", "end": "2025-09-07 15:58:21.506278", "msg": "", "rc": 0, "start": "2025-09-07 15:58:21.500146", "stderr": "", "stderr_lines": [], "stdout": "/snap/bin/gcloud", "stdout_lines": ["/snap/bin/gcloud"]***
2025-09-07T15:58:21.6920632Z 
2025-09-07T15:58:21.6921004Z TASK [Install Google Cloud SDK] ************************************************
2025-09-07T15:58:21.7082744Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "gcloud_check.rc != 0", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:21.7084058Z 
2025-09-07T15:58:21.7084530Z TASK [Stop existing bot process] ***********************************************
2025-09-07T15:58:21.7298278Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/stop_bot.yml for 34.30.73.146
2025-09-07T15:58:21.7298915Z 
2025-09-07T15:58:21.7299270Z TASK [Check if systemd service exists] *****************************************
2025-09-07T15:58:23.2585790Z ok: [34.30.73.146] => ***"changed": false, "stat": ***"exists": false***
2025-09-07T15:58:23.2586275Z 
2025-09-07T15:58:23.2586580Z TASK [Stop systemd service] ****************************************************
2025-09-07T15:58:23.2752893Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "systemd_service.stat.exists", "skip_reason": "Conditional result was False"***
2025-09-07T15:58:23.2754011Z 
2025-09-07T15:58:23.2754617Z TASK [Kill any running bot processes] ******************************************
2025-09-07T15:58:24.7180603Z fatal: [34.30.73.146]: FAILED! => ***"changed": true, "cmd": "pkill -f \"python.*participation_bot\" || true", "delta": "0:00:00.018770", "end": "2025-09-07 15:58:24.523953", "msg": "non-zero return code", "rc": -15, "start": "2025-09-07 15:58:24.505183", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []***
2025-09-07T15:58:24.7182059Z ...ignoring
2025-09-07T15:58:24.7182455Z 
2025-09-07T15:58:24.7182843Z TASK [Wait for processes to terminate] *****************************************
2025-09-07T15:58:27.7387940Z Pausing for 3 seconds
2025-09-07T15:58:27.7389552Z ok: [34.30.73.146] => ***"changed": false, "delta": 3, "echo": true, "rc": 0, "start": "2025-09-07 15:58:24.725397", "stderr": "", "stdout": "Paused for 3.0 seconds", "stop": "2025-09-07 15:58:27.729713", "user_input": ""***
2025-09-07T15:58:27.7390669Z 
2025-09-07T15:58:27.7391318Z TASK [Force kill any remaining bot processes] **********************************
2025-09-07T15:58:29.2666056Z fatal: [34.30.73.146]: FAILED! => ***"changed": true, "cmd": "pkill -9 -f \"python.*participation_bot\" || true", "delta": "0:00:00.012144", "end": "2025-09-07 15:58:29.080344", "msg": "non-zero return code", "rc": -9, "start": "2025-09-07 15:58:29.068200", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []***
2025-09-07T15:58:29.2668114Z ...ignoring
2025-09-07T15:58:29.2668486Z 
2025-09-07T15:58:29.2668986Z TASK [Check if bot PID file exists] ********************************************
2025-09-07T15:58:30.7050195Z ok: [34.30.73.146] => ***"changed": false, "stat": ***"exists": false***
2025-09-07T15:58:30.7050710Z 
2025-09-07T15:58:30.7051071Z TASK [Remove PID file] *********************************************************
2025-09-07T15:58:32.2778757Z ok: [34.30.73.146] => ***"changed": false, "path": "/app/bot.pid", "state": "absent"***
2025-09-07T15:58:32.2779288Z 
2025-09-07T15:58:32.2779694Z TASK [Clean and prepare application directory] *********************************
2025-09-07T15:58:33.7376049Z ok: [34.30.73.146] => ***"changed": false, "path": "/app", "state": "absent"***
2025-09-07T15:58:33.7376613Z 
2025-09-07T15:58:33.7377031Z TASK [Create application directory] ********************************************
2025-09-07T15:58:35.1798010Z changed: [34.30.73.146] => ***"changed": true, "gid": 1000, "group": "ubuntu", "mode": "0755", "owner": "ubuntu", "path": "/app", "size": 4096, "state": "directory", "uid": 1000***
2025-09-07T15:58:35.1798815Z 
2025-09-07T15:58:35.1799186Z TASK [Copy application code] ***************************************************
2025-09-07T16:09:13.9099162Z changed: [34.30.73.146] => ***"changed": true, "dest": "/app/", "src": "/home/runner/work/red-legion-bots/red-legion-bots/"***
2025-09-07T16:09:13.9099841Z 
2025-09-07T16:09:13.9100247Z TASK [Install requirements with pip3 (system-wide)] ****************************
2025-09-07T16:09:17.5597705Z ok: [34.30.73.146] => ***"changed": false, "cmd": ["/usr/bin/pip3", "install", "-r", "/app/requirements.txt"], "name": null, "requirements": "/app/requirements.txt", "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning."], "stdout": "Requirement already satisfied: discord.py==2.4.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 1)) (2.4.0)\nRequirement already satisfied: psycopg2-binary==2.9.9 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 2)) (2.9.9)\nRequirement already satisfied: python-dotenv==1.0.1 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 3)) (1.0.1)\nRequirement already satisfied: aiohttp==3.9.5 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 4)) (3.9.5)\nRequirement already satisfied: psutil==5.9.8 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 5)) (5.9.8)\nRequirement already satisfied: asyncpg==0.29.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 6)) (0.29.0)\nRequirement already satisfied: google-cloud-secret-manager==2.20.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 7)) (2.20.0)\nRequirement already satisfied: reportlab==4.0.4 in /usr/local/lib/python3.10/dist-packages (from -r /app/requirements.txt (line 8)) (4.0.4)\nRequirement already satisfied: aiosignal>=1.1.2 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.4.0)\nRequirement already satisfied: attrs>=17.3.0 in /usr/lib/python3/dist-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (21.2.0)\nRequirement already satisfied: frozenlist>=1.1.1 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.7.0)\nRequirement already satisfied: multidict<7.0,>=4.5 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (6.6.4)\nRequirement already satisfied: yarl<2.0,>=1.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.20.1)\nRequirement already satisfied: async-timeout<5.0,>=4.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.0.3)\nRequirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)\nRequirement already satisfied: google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.40.3)\nRequirement already satisfied: proto-plus<2.0.0dev,>=1.22.3 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.26.1)\nRequirement already satisfied: protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.25.8)\nRequirement already satisfied: grpc-google-iam-v1<1.0.0dev,>=0.12.4 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.14.2)\nRequirement already satisfied: pillow>=9.0.0 in /usr/local/lib/python3.10/dist-packages (from reportlab==4.0.4->-r /app/requirements.txt (line 8)) (11.3.0)\nRequirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in /root/.local/lib/python3.10/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.70.0)\nRequirement already satisfied: requests<3.0.0,>=2.18.0 in /usr/lib/python3/dist-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)\nRequirement already satisfied: grpcio<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.74.0)\nRequirement already satisfied: grpcio-status<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.62.3)\nRequirement already satisfied: cachetools<6.0,>=2.0.0 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (5.5.2)\nRequirement already satisfied: pyasn1-modules>=0.2.1 in /usr/lib/python3/dist-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.2.1)\nRequirement already satisfied: rsa<5,>=3.1.4 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.9.1)\nRequirement already satisfied: typing-extensions>=4.1.0 in /root/.local/lib/python3.10/site-packages (from multidict<7.0,>=4.5->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.15.0)\nRequirement already satisfied: pyasn1>=0.1.3 in /usr/lib/python3/dist-packages (from rsa<5,>=3.1.4->google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.4.8)\nRequirement already satisfied: idna>=2.0 in /usr/lib/python3/dist-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (3.3)\nRequirement already satisfied: propcache>=0.2.1 in /root/.local/lib/python3.10/site-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (0.3.2)\n", "stdout_lines": ["Requirement already satisfied: discord.py==2.4.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 1)) (2.4.0)", "Requirement already satisfied: psycopg2-binary==2.9.9 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 2)) (2.9.9)", "Requirement already satisfied: python-dotenv==1.0.1 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 3)) (1.0.1)", "Requirement already satisfied: aiohttp==3.9.5 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 4)) (3.9.5)", "Requirement already satisfied: psutil==5.9.8 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 5)) (5.9.8)", "Requirement already satisfied: asyncpg==0.29.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 6)) (0.29.0)", "Requirement already satisfied: google-cloud-secret-manager==2.20.0 in /root/.local/lib/python3.10/site-packages (from -r /app/requirements.txt (line 7)) (2.20.0)", "Requirement already satisfied: reportlab==4.0.4 in /usr/local/lib/python3.10/dist-packages (from -r /app/requirements.txt (line 8)) (4.0.4)", "Requirement already satisfied: aiosignal>=1.1.2 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.4.0)", "Requirement already satisfied: attrs>=17.3.0 in /usr/lib/python3/dist-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (21.2.0)", "Requirement already satisfied: frozenlist>=1.1.1 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.7.0)", "Requirement already satisfied: multidict<7.0,>=4.5 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (6.6.4)", "Requirement already satisfied: yarl<2.0,>=1.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (1.20.1)", "Requirement already satisfied: async-timeout<5.0,>=4.0 in /root/.local/lib/python3.10/site-packages (from aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.0.3)", "Requirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)", "Requirement already satisfied: google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.40.3)", "Requirement already satisfied: proto-plus<2.0.0dev,>=1.22.3 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.26.1)", "Requirement already satisfied: protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.19.5 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.25.8)", "Requirement already satisfied: grpc-google-iam-v1<1.0.0dev,>=0.12.4 in /root/.local/lib/python3.10/site-packages (from google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.14.2)", "Requirement already satisfied: pillow>=9.0.0 in /usr/local/lib/python3.10/dist-packages (from reportlab==4.0.4->-r /app/requirements.txt (line 8)) (11.3.0)", "Requirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in /root/.local/lib/python3.10/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.70.0)", "Requirement already satisfied: requests<3.0.0,>=2.18.0 in /usr/lib/python3/dist-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (2.25.1)", "Requirement already satisfied: grpcio<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.74.0)", "Requirement already satisfied: grpcio-status<2.0.0,>=1.33.2 in /root/.local/lib/python3.10/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0dev,>=1.34.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (1.62.3)", "Requirement already satisfied: cachetools<6.0,>=2.0.0 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (5.5.2)", "Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/lib/python3/dist-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.2.1)", "Requirement already satisfied: rsa<5,>=3.1.4 in /root/.local/lib/python3.10/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (4.9.1)", "Requirement already satisfied: typing-extensions>=4.1.0 in /root/.local/lib/python3.10/site-packages (from multidict<7.0,>=4.5->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (4.15.0)", "Requirement already satisfied: pyasn1>=0.1.3 in /usr/lib/python3/dist-packages (from rsa<5,>=3.1.4->google-auth!=2.24.0,!=2.25.0,<3.0.0dev,>=2.14.1->google-cloud-secret-manager==2.20.0->-r /app/requirements.txt (line 7)) (0.4.8)", "Requirement already satisfied: idna>=2.0 in /usr/lib/python3/dist-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (3.3)", "Requirement already satisfied: propcache>=0.2.1 in /root/.local/lib/python3.10/site-packages (from yarl<2.0,>=1.0->aiohttp==3.9.5->-r /app/requirements.txt (line 4)) (0.3.2)"], "version": null, "virtualenv": null***
2025-09-07T16:09:17.5638205Z 
2025-09-07T16:09:17.5638566Z TASK [Install psycopg2-binary with pip3 (system-wide)] *************************
2025-09-07T16:09:20.0056300Z ok: [34.30.73.146] => ***"changed": false, "cmd": ["/usr/bin/pip3", "install", "psycopg2-binary"], "name": ["psycopg2-binary"], "requirements": null, "state": "present", "stderr": "WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.\n", "stderr_lines": ["WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning."], "stdout": "Requirement already satisfied: psycopg2-binary in /root/.local/lib/python3.10/site-packages (2.9.9)\n", "stdout_lines": ["Requirement already satisfied: psycopg2-binary in /root/.local/lib/python3.10/site-packages (2.9.9)"], "version": null, "virtualenv": null***
2025-09-07T16:09:20.0063706Z 
2025-09-07T16:09:20.0064273Z TASK [Set up environment variables] ********************************************
2025-09-07T16:09:20.0266884Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/setup_environment.yml for 34.30.73.146
2025-09-07T16:09:20.0267649Z 
2025-09-07T16:09:20.0268094Z TASK [Set PYTHONPATH environment variable] *************************************
2025-09-07T16:09:21.6424814Z ok: [34.30.73.146] => ***"backup": "", "changed": false, "msg": ""***
2025-09-07T16:09:21.6425526Z 
2025-09-07T16:09:21.6426066Z TASK [Remove any cached .env files that might cause conflicts] *****************
2025-09-07T16:09:23.0606803Z ok: [34.30.73.146] => ***"changed": false, "path": "/app/.env", "state": "absent"***
2025-09-07T16:09:23.0607562Z 
2025-09-07T16:09:23.0608065Z TASK [Test Python imports] *****************************************************
2025-09-07T16:09:27.5840798Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "-c", "import sys; print('Python path:', sys.path); import src.participation_bot"], "delta": "0:00:03.070838", "end": "2025-09-07 16:09:27.378962", "failed_when_result": false, "msg": "", "rc": 0, "start": "2025-09-07 16:09:24.308124", "stderr": "", "stderr_lines": [], "stdout": "Python path: ['', '/app', '/app/$PYTHONPATH', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/root/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']\nDatabase URL encoding: Fixed special characters in password", "stdout_lines": ["Python path: ['', '/app', '/app/$PYTHONPATH', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/root/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']", "Database URL encoding: Fixed special characters in password"]***
2025-09-07T16:09:27.5844904Z 
2025-09-07T16:09:27.5845270Z TASK [Start bot service] *******************************************************
2025-09-07T16:09:27.6092535Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/start_bot.yml for 34.30.73.146
2025-09-07T16:09:27.6093479Z 
2025-09-07T16:09:27.6093922Z TASK [Run configuration validation] ********************************************
2025-09-07T16:09:30.2004190Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "scripts/validate_config.py"], "delta": "0:00:01.064743", "end": "2025-09-07 16:09:30.012654", "msg": "", "rc": 0, "start": "2025-09-07 16:09:28.947911", "stderr": "", "stderr_lines": [], "stdout": "🎯 Red Legion Bot Configuration Validator\n==================================================\n🧪 Testing imports...\n   ✅ Config imports successful\n🧪 Testing environment configuration...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database URL configured\n   ✅ Discord token configured\n🧪 Testing database connection...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database connection successful\n🧪 Testing Secret Manager access...\n   ✅ Secret Manager accessible (test secret not found, which is expected)\n\n==================================================\n📊 Validation Results:\n   ✅ PASS Imports\n   ✅ PASS Environment\n   ✅ PASS Database Connection\n   ✅ PASS Secret Manager\n\n🎉 All validation tests passed! Bot is ready to start.", "stdout_lines": ["🎯 Red Legion Bot Configuration Validator", "==================================================", "🧪 Testing imports...", "   ✅ Config imports successful", "🧪 Testing environment configuration...", "Database URL encoding: Fixed special characters in password", "   ✅ Database URL configured", "   ✅ Discord token configured", "🧪 Testing database connection...", "Database URL encoding: Fixed special characters in password", "   ✅ Database connection successful", "🧪 Testing Secret Manager access...", "   ✅ Secret Manager accessible (test secret not found, which is expected)", "", "==================================================", "📊 Validation Results:", "   ✅ PASS Imports", "   ✅ PASS Environment", "   ✅ PASS Database Connection", "   ✅ PASS Secret Manager", "", "🎉 All validation tests passed! Bot is ready to start."]***
2025-09-07T16:09:30.2016002Z 
2025-09-07T16:09:30.2016593Z TASK [Show configuration validation result] ************************************
2025-09-07T16:09:30.2263666Z ok: [34.30.73.146] => ***
2025-09-07T16:09:30.2268441Z     "msg": "Configuration validation: PASSED - 🎯 Red Legion Bot Configuration Validator\n==================================================\n🧪 Testing imports...\n   ✅ Config imports successful\n🧪 Testing environment configuration...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database URL configured\n   ✅ Discord token configured\n🧪 Testing database connection...\nDatabase URL encoding: Fixed special characters in password\n   ✅ Database connection successful\n🧪 Testing Secret Manager access...\n   ✅ Secret Manager accessible (test secret not found, which is expected)\n\n==================================================\n📊 Validation Results:\n   ✅ PASS Imports\n   ✅ PASS Environment\n   ✅ PASS Database Connection\n   ✅ PASS Secret Manager\n\n🎉 All validation tests passed! Bot is ready to start."
2025-09-07T16:09:30.2272775Z ***
2025-09-07T16:09:30.2273048Z 
2025-09-07T16:09:30.2273492Z TASK [Test Python imports before starting bot] *********************************
2025-09-07T16:09:32.3567577Z changed: [34.30.73.146] => ***"changed": true, "cmd": ["python3", "-c", "import sys; sys.path.insert(0, 'src'); from config.settings import get_database_url; print('Import successful, DB URL configured:', bool(get_database_url()))"], "delta": "0:00:00.594193", "end": "2025-09-07 16:09:32.165976", "msg": "", "rc": 0, "start": "2025-09-07 16:09:31.571783", "stderr": "", "stderr_lines": [], "stdout": "Database URL encoding: Fixed special characters in password\nImport successful, DB URL configured: True", "stdout_lines": ["Database URL encoding: Fixed special characters in password", "Import successful, DB URL configured: True"]***
2025-09-07T16:09:32.3569861Z 
2025-09-07T16:09:32.3570205Z TASK [Show import test result] *************************************************
2025-09-07T16:09:32.3823709Z ok: [34.30.73.146] => ***
2025-09-07T16:09:32.3824665Z     "msg": "Import test result: Database URL encoding: Fixed special characters in password\nImport successful, DB URL configured: True"
2025-09-07T16:09:32.3825499Z ***
2025-09-07T16:09:32.3825709Z 
2025-09-07T16:09:32.3826043Z TASK [Create environment file from template] ***********************************
2025-09-07T16:09:35.6302915Z changed: [34.30.73.146] => ***"changed": true, "checksum": "a974a4f3ee2ec4647427d36713d12cb9940147b7", "dest": "/app/.env", "gid": 0, "group": "root", "md5sum": "87eb36bf35058f17fde58db0ef954cb3", "mode": "0600", "owner": "root", "size": 252, "src": "/home/ubuntu/.ansible/tmp/ansible-tmp-1757261372.5146785-5251-90852088897410/source", "state": "file", "uid": 0***
2025-09-07T16:09:35.6304611Z 
2025-09-07T16:09:35.6305022Z TASK [Create systemd service file] *********************************************
2025-09-07T16:09:38.7522909Z changed: [34.30.73.146] => ***"changed": true, "checksum": "20aa619ed0f91e7f49f85c45ed43910fbf031864", "dest": "/etc/systemd/system/red-legion-bot.service", "gid": 0, "group": "root", "md5sum": "2f294916dcc7f3444ac821921d97a336", "mode": "0644", "owner": "root", "size": 430, "src": "/home/ubuntu/.ansible/tmp/ansible-tmp-1757261375.7566345-5267-248483539279290/source", "state": "file", "uid": 0***
2025-09-07T16:09:38.7524532Z 
2025-09-07T16:09:38.7524875Z TASK [Reload systemd daemon] ***************************************************
2025-09-07T16:09:41.1740052Z ok: [34.30.73.146] => ***"changed": false, "name": null, "status": ***
2025-09-07T16:09:41.1740577Z 
2025-09-07T16:09:41.1740939Z TASK [Enable and start systemd service] ****************************************
2025-09-07T16:09:43.3800455Z changed: [34.30.73.146] => ***"changed": true, "enabled": true, "name": "red-legion-bot", "state": "started", "status": ***"ActiveEnterTimestamp": "n/a", "ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "network-online.target basic.target -.mount systemd-journald.socket network.target system.slice sysinit.target", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestamp": "n/a", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestamp": "n/a", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Red Legion Discord Bot", "DevicePolicy": "auto", "DynamicUser": "no", "Environment": "PYTHONUNBUFFERED=1 GOOGLE_CLOUD_PROJECT=rl-prod-471116", "EnvironmentFiles": "/app/.env (ignore_errors=no)", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestamp": "n/a", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecStart": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 ***", "ExecStartEx": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 ***", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/etc/systemd/system/red-legion-bot.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "red-legion-bot.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "n/a", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "2190", "LimitNPROCSoft": "2190", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "2190", "LimitSIGPENDINGSoft": "2190", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "red-legion-bot.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "-.mount sysinit.target system.slice", "RequiresMountsFor": "/app", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "10s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "journal", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "n/a", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "657", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "User": "root", "UtmpMode": "init", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity", "WorkingDirectory": "/app"***
2025-09-07T16:09:43.3824455Z 
2025-09-07T16:09:43.3824776Z TASK [Show startup debug info] *************************************************
2025-09-07T16:09:43.4033558Z ok: [34.30.73.146] => ***
2025-09-07T16:09:43.4034088Z     "msg": "Systemd service started: True"
2025-09-07T16:09:43.4034635Z ***
2025-09-07T16:09:43.4034848Z 
2025-09-07T16:09:43.4035145Z TASK [Wait for bot to start] ***************************************************
2025-09-07T16:09:46.4277755Z Pausing for 3 seconds
2025-09-07T16:09:46.4279045Z ok: [34.30.73.146] => ***"changed": false, "delta": 3, "echo": true, "rc": 0, "start": "2025-09-07 16:09:43.414272", "stderr": "", "stdout": "Paused for 3.0 seconds", "stop": "2025-09-07 16:09:46.418649", "user_input": ""***
2025-09-07T16:09:46.4279976Z 
2025-09-07T16:09:46.4280374Z TASK [Verify bot service is running] *******************************************
2025-09-07T16:09:48.2574933Z ok: [34.30.73.146] => ***"changed": false, "name": "red-legion-bot", "status": ***"ActiveEnterTimestamp": "Sun 2025-09-07 16:09:43 UTC", "ActiveEnterTimestampMonotonic": "3850363229", "ActiveExitTimestamp": "n/a", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "network-online.target basic.target systemd-journald.socket -.mount sysinit.target network.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-09-07 16:09:43 UTC", "AssertTimestampMonotonic": "3850356174", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "494091000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-09-07 16:09:43 UTC", "ConditionTimestampMonotonic": "3850356172", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/red-legion-bot.service", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Red Legion Discord Bot", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "PYTHONUNBUFFERED=1 GOOGLE_CLOUD_PROJECT=rl-prod-471116", "EnvironmentFiles": "/app/.env (ignore_errors=no)", "ExecMainCode": "0", "ExecMainExitTimestamp": "n/a", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "16618", "ExecMainStartTimestamp": "Sun 2025-09-07 16:09:43 UTC", "ExecMainStartTimestampMonotonic": "3850361182", "ExecMainStatus": "0", "ExecStart": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; ignore_errors=no ; start_time=[Sun 2025-09-07 16:09:43 UTC] ; stop_time=[n/a] ; pid=16618 ; code=(null) ; status=0/0 ***", "ExecStartEx": "*** path=/usr/bin/python3 ; argv[]=/usr/bin/python3 src/main.py ; flags= ; start_time=[Sun 2025-09-07 16:09:43 UTC] ; stop_time=[n/a] ; pid=16618 ; code=(null) ; status=0/0 ***", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/etc/systemd/system/red-legion-bot.service", "FreezerState": "running", "GID": "0", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "red-legion-bot.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "n/a", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sun 2025-09-07 16:09:43 UTC", "InactiveExitTimestampMonotonic": "3850363229", "InvocationID": "940d226321fd485bbef92c0c1a271149", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "2190", "LimitNPROCSoft": "2190", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "2190", "LimitSIGPENDINGSoft": "2190", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "16618", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "40460288", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "red-legion-bot.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice -.mount", "RequiresMountsFor": "/app", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "10s", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "journal", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-09-07 16:09:43 UTC", "StateChangeTimestampMonotonic": "3850363229", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "1", "TasksMax": "657", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "0", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "root", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestamp": "n/a", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0", "WorkingDirectory": "/app"***
2025-09-07T16:09:48.2617362Z 
2025-09-07T16:09:48.2617845Z TASK [Show service status] *****************************************************
2025-09-07T16:09:48.2872057Z ok: [34.30.73.146] => ***
2025-09-07T16:09:48.2872845Z     "msg": "Service status: active"
2025-09-07T16:09:48.2873344Z ***
2025-09-07T16:09:48.2873857Z 
2025-09-07T16:09:48.2874186Z TASK [Check service logs if failed] ********************************************
2025-09-07T16:09:48.3096976Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "not ansible_check_mode and service_status is defined and service_status.status.ActiveState != 'active'", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:48.3097871Z 
2025-09-07T16:09:48.3098209Z TASK [Fail with service logs if service not active] ****************************
2025-09-07T16:09:48.3310162Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "not ansible_check_mode and service_status is defined and service_status.status.ActiveState != 'active'", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:48.3311079Z 
2025-09-07T16:09:48.3311392Z TASK [Verify bot is running] ***************************************************
2025-09-07T16:09:48.3567061Z included: /home/runner/work/red-legion-bots/red-legion-bots/ansible/tasks/verify_bot.yml for 34.30.73.146
2025-09-07T16:09:48.3567865Z 
2025-09-07T16:09:48.3568279Z TASK [Check if bot PID file exists] ********************************************
2025-09-07T16:09:49.7370855Z ok: [34.30.73.146] => ***"changed": false, "stat": ***"exists": false***
2025-09-07T16:09:49.7371569Z 
2025-09-07T16:09:49.7372104Z TASK [Verify bot process is running] *******************************************
2025-09-07T16:09:49.7599248Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.7600219Z 
2025-09-07T16:09:49.7600534Z TASK [Check bot log for errors] ************************************************
2025-09-07T16:09:49.7815856Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.7816827Z 
2025-09-07T16:09:49.7817154Z TASK [Display recent log entries] **********************************************
2025-09-07T16:09:49.8025547Z skipping: [34.30.73.146] => ***"false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode"***
2025-09-07T16:09:49.8026287Z 
2025-09-07T16:09:49.8026630Z TASK [Check for error patterns in log] *****************************************
2025-09-07T16:09:49.8238565Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.8239539Z 
2025-09-07T16:09:49.8239840Z TASK [Read PID from file] ******************************************************
2025-09-07T16:09:49.8481711Z skipping: [34.30.73.146] => ***"changed": false, "false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and not ansible_check_mode", "skip_reason": "Conditional result was False"***
2025-09-07T16:09:49.8483003Z 
2025-09-07T16:09:49.8483374Z TASK [Report successful deployment] ********************************************
2025-09-07T16:09:49.8805045Z skipping: [34.30.73.146] => ***"false_condition": "pid_file_check is defined and pid_file_check.stat is defined and pid_file_check.stat.exists and process_check is defined and (process_check.rc | default(0)) == 0 and pid_content is defined and not ansible_check_mode"***
2025-09-07T16:09:49.8806082Z 
2025-09-07T16:09:49.8806401Z TASK [Clean up temporary files] ************************************************
2025-09-07T16:09:54.1825974Z changed: [34.30.73.146] => (item=/app/.git) => ***"ansible_loop_var": "item", "changed": true, "item": "/app/.git", "path": "/app/.git", "state": "absent"***
2025-09-07T16:09:54.1827642Z changed: [34.30.73.146] => (item=/app/ansible) => ***"ansible_loop_var": "item", "changed": true, "item": "/app/ansible", "path": "/app/ansible", "state": "absent"***
2025-09-07T16:09:54.1829597Z changed: [34.30.73.146] => (item=/app/tests) => ***"ansible_loop_var": "item", "changed": true, "item": "/app/tests", "path": "/app/tests", "state": "absent"***
2025-09-07T16:09:54.1830443Z 
2025-09-07T16:09:54.1830909Z RUNNING HANDLER [reload systemd] ***********************************************
2025-09-07T16:09:56.2626667Z ok: [34.30.73.146] => ***"changed": false, "name": null, "status": ***
2025-09-07T16:09:56.2627377Z 
2025-09-07T16:09:56.2627706Z PLAY RECAP *********************************************************************
2025-09-07T16:09:56.2628610Z 34.30.73.146               : ok=43   changed=16   unreachable=0    failed=0    skipped=17   rescued=0    ignored=3   
2025-09-07T16:09:56.2629179Z 
2025-09-07T16:09:56.3196193Z === Ansible deployment completed ===
2025-09-07T16:09:56.3196941Z === Waiting for bot to stabilize ===
2025-09-07T16:10:06.3219675Z === Bot startup wait completed ===
2025-09-07T16:10:06.3257635Z ##[group]Run echo "=== Discord Bot Health Check ==="
2025-09-07T16:10:06.3258324Z [36;1mecho "=== Discord Bot Health Check ==="[0m
2025-09-07T16:10:06.3258830Z [36;1m[0m
2025-09-07T16:10:06.3259286Z [36;1m# Function to check if bot responds to Discord[0m
2025-09-07T16:10:06.3259849Z [36;1mcheck_discord_health() ***[0m
2025-09-07T16:10:06.3260336Z [36;1m  local max_attempts=3[0m
2025-09-07T16:10:06.3260792Z [36;1m  local attempt=1[0m
2025-09-07T16:10:06.3261220Z [36;1m  [0m
2025-09-07T16:10:06.3261663Z [36;1m  while [ $attempt -le $max_attempts ]; do[0m
2025-09-07T16:10:06.3262277Z [36;1m    echo "Health check attempt $attempt/$max_attempts..."[0m
2025-09-07T16:10:06.3263047Z [36;1m    [0m
2025-09-07T16:10:06.3263570Z [36;1m    # Send a test message to Discord and check if bot processes it[0m
2025-09-07T16:10:06.3264212Z [36;1m    # Using a simple API call to check if bot is online[0m
2025-09-07T16:10:06.3264811Z [36;1m    HEALTH_CHECK=$(curl -s -X GET \[0m
2025-09-07T16:10:06.3265394Z [36;1m      "https://discord.com/api/v10/applications/@me" \[0m
2025-09-07T16:10:06.3266221Z [36;1m      -H "Authorization: Bot ***" \[0m
2025-09-07T16:10:06.3266749Z [36;1m      -H "Content-Type: application/json")[0m
2025-09-07T16:10:06.3267247Z [36;1m    [0m
2025-09-07T16:10:06.3267697Z [36;1m    if echo "$HEALTH_CHECK" | grep -q '"id"'; then[0m
2025-09-07T16:10:06.3268331Z [36;1m      echo "✅ Bot is authenticated and responding to Discord API"[0m
2025-09-07T16:10:06.3268891Z [36;1m      [0m
2025-09-07T16:10:06.3269398Z [36;1m      # Additional check: verify bot can access guild information[0m
2025-09-07T16:10:06.3269977Z [36;1m      GUILD_CHECK=$(curl -s -X GET \[0m
2025-09-07T16:10:06.3270546Z [36;1m        "https://discord.com/api/v10/users/@me/guilds" \[0m
2025-09-07T16:10:06.3271361Z [36;1m        -H "Authorization: Bot ***" \[0m
2025-09-07T16:10:06.3271894Z [36;1m        -H "Content-Type: application/json")[0m
2025-09-07T16:10:06.3272578Z [36;1m      [0m
2025-09-07T16:10:06.3273054Z [36;1m      if echo "$GUILD_CHECK" | grep -q '\[.*\]'; then[0m
2025-09-07T16:10:06.3273617Z [36;1m        echo "✅ Bot can access guild information"[0m
2025-09-07T16:10:06.3274169Z [36;1m        echo "✅ Discord health check PASSED"[0m
2025-09-07T16:10:06.3274675Z [36;1m        return 0[0m
2025-09-07T16:10:06.3275094Z [36;1m      else[0m
2025-09-07T16:10:06.3275591Z [36;1m        echo "⚠️ Bot authenticated but cannot access guilds"[0m
2025-09-07T16:10:06.3276121Z [36;1m      fi[0m
2025-09-07T16:10:06.3276516Z [36;1m    else[0m
2025-09-07T16:10:06.3276966Z [36;1m      echo "❌ Bot not responding to Discord API"[0m
2025-09-07T16:10:06.3277479Z [36;1m    fi[0m
2025-09-07T16:10:06.3277881Z [36;1m    [0m
2025-09-07T16:10:06.3278325Z [36;1m    echo "Waiting 10 seconds before retry..."[0m
2025-09-07T16:10:06.3278838Z [36;1m    sleep 10[0m
2025-09-07T16:10:06.3279276Z [36;1m    attempt=$((attempt + 1))[0m
2025-09-07T16:10:06.3279927Z [36;1m  done[0m
2025-09-07T16:10:06.3280323Z [36;1m  [0m
2025-09-07T16:10:06.3280837Z [36;1m  echo "❌ Discord health check FAILED after $max_attempts attempts"[0m
2025-09-07T16:10:06.3281402Z [36;1m  return 1[0m
2025-09-07T16:10:06.3281819Z [36;1m***[0m
2025-09-07T16:10:06.3282202Z [36;1m[0m
2025-09-07T16:10:06.3282821Z [36;1m# Also check if process exists (supplementary check)[0m
2025-09-07T16:10:06.3283389Z [36;1mecho "=== Process Status Check ==="[0m
2025-09-07T16:10:06.3283897Z [36;1mif [ -f "/app/bot.pid" ]; then[0m
2025-09-07T16:10:06.3284395Z [36;1m  PID=$(cat /app/bot.pid)[0m
2025-09-07T16:10:06.3284889Z [36;1m  echo "Found PID file with PID: $PID"[0m
2025-09-07T16:10:06.3285369Z [36;1m  [0m
2025-09-07T16:10:06.3285801Z [36;1m  if ps -p "$PID" > /dev/null 2>&1; then[0m
2025-09-07T16:10:06.3286344Z [36;1m    echo "✅ Bot process is running (PID: $PID)"[0m
2025-09-07T16:10:06.3286878Z [36;1m    PROCESS_STATUS="running"[0m
2025-09-07T16:10:06.3287358Z [36;1m  else[0m
2025-09-07T16:10:06.3288034Z [36;1m    echo "⚠️ Bot process not found, but this may be a false negative"[0m
2025-09-07T16:10:06.3288639Z [36;1m    PROCESS_STATUS="unknown"[0m
2025-09-07T16:10:06.3289118Z [36;1m  fi[0m
2025-09-07T16:10:06.3289508Z [36;1melse[0m
2025-09-07T16:10:06.3289961Z [36;1m  echo "⚠️ No PID file found at /app/bot.pid"[0m
2025-09-07T16:10:06.3290494Z [36;1m  PROCESS_STATUS="no_pid"[0m
2025-09-07T16:10:06.3290955Z [36;1mfi[0m
2025-09-07T16:10:06.3291341Z [36;1m[0m
2025-09-07T16:10:06.3291751Z [36;1m# Check recent bot logs for activity[0m
2025-09-07T16:10:06.3292267Z [36;1mecho "=== Bot Log Analysis ==="[0m
2025-09-07T16:10:06.3292927Z [36;1mif [ -f "/app/bot.log" ]; then[0m
2025-09-07T16:10:06.3293427Z [36;1m  echo "Recent bot log entries:"[0m
2025-09-07T16:10:06.3293917Z [36;1m  tail -10 /app/bot.log[0m
2025-09-07T16:10:06.3294362Z [36;1m  [0m
2025-09-07T16:10:06.3294803Z [36;1m  # Check for recent heartbeat messages[0m
2025-09-07T16:10:06.3295423Z [36;1m  if grep -q "Heartbeat: Bot is still running" /app/bot.log; then[0m
2025-09-07T16:10:06.3296153Z [36;1m    LAST_HEARTBEAT=$(grep "Heartbeat: Bot is still running" /app/bot.log | tail -1)[0m
2025-09-07T16:10:06.3296808Z [36;1m    echo "✅ Found heartbeat: $LAST_HEARTBEAT"[0m
2025-09-07T16:10:06.3297307Z [36;1m  else[0m
2025-09-07T16:10:06.3297763Z [36;1m    echo "⚠️ No recent heartbeat messages found"[0m
2025-09-07T16:10:06.3298270Z [36;1m  fi[0m
2025-09-07T16:10:06.3298656Z [36;1m  [0m
2025-09-07T16:10:06.3299065Z [36;1m  # Check for errors in recent logs[0m
2025-09-07T16:10:06.3299686Z [36;1m  if tail -20 /app/bot.log | grep -i "error\|exception\|failed" > /dev/null; then[0m
2025-09-07T16:10:06.3300318Z [36;1m    echo "⚠️ Recent errors found in logs:"[0m
2025-09-07T16:10:06.3300911Z [36;1m    tail -20 /app/bot.log | grep -i "error\|exception\|failed"[0m
2025-09-07T16:10:06.3301456Z [36;1m  else[0m
2025-09-07T16:10:06.3301885Z [36;1m    echo "✅ No recent errors in bot logs"[0m
2025-09-07T16:10:06.3302604Z [36;1m  fi[0m
2025-09-07T16:10:06.3303000Z [36;1melse[0m
2025-09-07T16:10:06.3303414Z [36;1m  echo "⚠️ No bot log file found"[0m
2025-09-07T16:10:06.3303882Z [36;1mfi[0m
2025-09-07T16:10:06.3304270Z [36;1m[0m
2025-09-07T16:10:06.3304707Z [36;1m# Primary health check: Discord API response[0m
2025-09-07T16:10:06.3305233Z [36;1mif check_discord_health; then[0m
2025-09-07T16:10:06.3305704Z [36;1m  echo ""[0m
2025-09-07T16:10:06.3306145Z [36;1m  echo "🎉 === HEALTH CHECK SUMMARY ==="[0m
2025-09-07T16:10:06.3306707Z [36;1m  echo "✅ PRIMARY: Discord API health check PASSED"[0m
2025-09-07T16:10:06.3307274Z [36;1m  echo "ℹ️  Process status: $PROCESS_STATUS"[0m
2025-09-07T16:10:06.3307865Z [36;1m  echo "✅ Bot is confirmed working and responding to Discord"[0m
2025-09-07T16:10:06.3308449Z [36;1m  echo "✅ Deployment is SUCCESSFUL"[0m
2025-09-07T16:10:06.3308925Z [36;1m  exit 0[0m
2025-09-07T16:10:06.3309327Z [36;1melse[0m
2025-09-07T16:10:06.3309714Z [36;1m  echo ""[0m
2025-09-07T16:10:06.3310299Z [36;1m  echo "❌ === HEALTH CHECK SUMMARY ==="[0m
2025-09-07T16:10:06.3310852Z [36;1m  echo "❌ PRIMARY: Discord API health check FAILED"[0m
2025-09-07T16:10:06.3311411Z [36;1m  echo "ℹ️  Process status: $PROCESS_STATUS"[0m
2025-09-07T16:10:06.3312000Z [36;1m  echo "❌ Bot may not be responding to Discord properly"[0m
2025-09-07T16:10:06.3312765Z [36;1m  echo "Check logs above for details"[0m
2025-09-07T16:10:06.3313250Z [36;1m  exit 1[0m
2025-09-07T16:10:06.3313643Z [36;1mfi[0m
2025-09-07T16:10:06.3344110Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail ***0***
2025-09-07T16:10:06.3344688Z env:
2025-09-07T16:10:06.3345347Z   DATABASE_URL: ***
2025-09-07T16:10:06.3346080Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T16:10:06.3347130Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T16:10:06.3348260Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T16:10:06.3349005Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T16:10:06.3349512Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T16:10:06.3349992Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T16:10:06.3350475Z   GCP_PROJECT: rl-prod-471116
2025-09-07T16:10:06.3350941Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T16:10:06.3351498Z   pythonLocation: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.3352181Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib/pkgconfig
2025-09-07T16:10:06.3352946Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.3353549Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.3354143Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.3354744Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib
2025-09-07T16:10:06.3355283Z ##[endgroup]
2025-09-07T16:10:06.3407378Z === Discord Bot Health Check ===
2025-09-07T16:10:06.3408628Z === Process Status Check ===
2025-09-07T16:10:06.3409601Z ⚠️ No PID file found at /app/bot.pid
2025-09-07T16:10:06.3410166Z === Bot Log Analysis ===
2025-09-07T16:10:06.3410794Z ⚠️ No bot log file found
2025-09-07T16:10:06.3411246Z Health check attempt 1/3...
2025-09-07T16:10:06.6369553Z ✅ Bot is authenticated and responding to Discord API
2025-09-07T16:10:06.9389169Z ✅ Bot can access guild information
2025-09-07T16:10:06.9390141Z ✅ Discord health check PASSED
2025-09-07T16:10:06.9390782Z 
2025-09-07T16:10:06.9391212Z 🎉 === HEALTH CHECK SUMMARY ===
2025-09-07T16:10:06.9391962Z ✅ PRIMARY: Discord API health check PASSED
2025-09-07T16:10:06.9392759Z ℹ️  Process status: no_pid
2025-09-07T16:10:06.9393330Z ✅ Bot is confirmed working and responding to Discord
2025-09-07T16:10:06.9393909Z ✅ Deployment is SUCCESSFUL
2025-09-07T16:10:06.9443197Z ##[group]Run echo "=== Final deployment status ==="
2025-09-07T16:10:06.9443888Z [36;1mecho "=== Final deployment status ==="[0m
2025-09-07T16:10:06.9444386Z [36;1m[0m
2025-09-07T16:10:06.9444829Z [36;1m# Use gcloud SSH to check deployment status[0m
2025-09-07T16:10:06.9445581Z [36;1mgcloud compute ssh arccorp-compute --zone=us-central1-a --project=rl-prod-471116 --command='[0m
2025-09-07T16:10:06.9446302Z [36;1m  # Check if this is a first deployment[0m
2025-09-07T16:10:06.9446817Z [36;1m  if [ ! -d /app ]; then[0m
2025-09-07T16:10:06.9447437Z [36;1m    echo "ℹ️  First deployment in progress - /app directory does not exist yet"[0m
2025-09-07T16:10:06.9448098Z [36;1m    echo "This is normal during initial setup"[0m
2025-09-07T16:10:06.9448644Z [36;1m    echo "=== System resource check ==="[0m
2025-09-07T16:10:06.9449181Z [36;1m    free -h || echo "Could not check memory"[0m
2025-09-07T16:10:06.9449777Z [36;1m    echo "=== Deployment log capture completed ==="[0m
2025-09-07T16:10:06.9450298Z [36;1m    exit 0[0m
2025-09-07T16:10:06.9450702Z [36;1m  fi[0m
2025-09-07T16:10:06.9451267Z [36;1m  [0m
2025-09-07T16:10:06.9451658Z [36;1m  # Show bot status[0m
2025-09-07T16:10:06.9452107Z [36;1m  if [ -f /app/bot.pid ]; then[0m
2025-09-07T16:10:06.9452974Z [36;1m    if kill -0 $(cat /app/bot.pid) 2>/dev/null; then[0m
2025-09-07T16:10:06.9453574Z [36;1m      echo "✅ Bot is running (PID: $(cat /app/bot.pid))"[0m
2025-09-07T16:10:06.9454103Z [36;1m    else[0m
2025-09-07T16:10:06.9454557Z [36;1m      echo "❌ Bot process exists but is not running"[0m
2025-09-07T16:10:06.9455063Z [36;1m    fi[0m
2025-09-07T16:10:06.9455455Z [36;1m  else[0m
2025-09-07T16:10:06.9455869Z [36;1m    echo "❌ No bot PID file found"[0m
2025-09-07T16:10:06.9456337Z [36;1m  fi[0m
2025-09-07T16:10:06.9456722Z [36;1m  [0m
2025-09-07T16:10:06.9457110Z [36;1m  # Show recent logs[0m
2025-09-07T16:10:06.9457561Z [36;1m  if [ -f /app/bot.log ]; then[0m
2025-09-07T16:10:06.9458080Z [36;1m    echo "=== Last 20 lines of bot log ==="[0m
2025-09-07T16:10:06.9458589Z [36;1m    tail -20 /app/bot.log[0m
2025-09-07T16:10:06.9459063Z [36;1m  else[0m
2025-09-07T16:10:06.9459481Z [36;1m    echo "❌ No bot log file found"[0m
2025-09-07T16:10:06.9459948Z [36;1m  fi[0m
2025-09-07T16:10:06.9460331Z [36;1m  [0m
2025-09-07T16:10:06.9460734Z [36;1m  # Check system resources[0m
2025-09-07T16:10:06.9461222Z [36;1m  echo "=== System resource check ==="[0m
2025-09-07T16:10:06.9461712Z [36;1m  if [ -d /app ]; then[0m
2025-09-07T16:10:06.9462250Z [36;1m    df -h /app || echo "Could not check disk space for /app"[0m
2025-09-07T16:10:06.9462975Z [36;1m  else[0m
2025-09-07T16:10:06.9463427Z [36;1m    df -h / || echo "Could not check disk space"[0m
2025-09-07T16:10:06.9463930Z [36;1m  fi[0m
2025-09-07T16:10:06.9464355Z [36;1m  free -h || echo "Could not check memory"[0m
2025-09-07T16:10:06.9464863Z [36;1m  [0m
2025-09-07T16:10:06.9465308Z [36;1m  echo "=== Deployment log capture completed ==="[0m
2025-09-07T16:10:06.9465939Z [36;1m' || echo "Could not capture deployment logs - VM may be unreachable"[0m
2025-09-07T16:10:06.9496570Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail ***0***
2025-09-07T16:10:06.9497153Z env:
2025-09-07T16:10:06.9497813Z   DATABASE_URL: ***
2025-09-07T16:10:06.9498541Z   CLOUDSDK_AUTH_CREDENTIAL_FILE_OVERRIDE: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T16:10:06.9499576Z   GOOGLE_APPLICATION_CREDENTIALS: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T16:10:06.9500540Z   GOOGLE_GHA_CREDS_PATH: /home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json
2025-09-07T16:10:06.9501245Z   CLOUDSDK_CORE_PROJECT: rl-prod-471116
2025-09-07T16:10:06.9501746Z   CLOUDSDK_PROJECT: rl-prod-471116
2025-09-07T16:10:06.9502219Z   GCLOUD_PROJECT: rl-prod-471116
2025-09-07T16:10:06.9502888Z   GCP_PROJECT: rl-prod-471116
2025-09-07T16:10:06.9503529Z   GOOGLE_CLOUD_PROJECT: rl-prod-471116
2025-09-07T16:10:06.9504102Z   pythonLocation: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.9504787Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib/pkgconfig
2025-09-07T16:10:06.9505427Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.9506021Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.9506613Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.9.23/x64
2025-09-07T16:10:06.9507198Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.9.23/x64/lib
2025-09-07T16:10:06.9507735Z ##[endgroup]
2025-09-07T16:10:06.9559906Z === Final deployment status ===
2025-09-07T16:10:10.2491256Z ❌ No bot PID file found
2025-09-07T16:10:10.2492123Z ❌ No bot log file found
2025-09-07T16:10:10.2492991Z === System resource check ===
2025-09-07T16:10:10.2520161Z Filesystem      Size  Used Avail Use% Mounted on
2025-09-07T16:10:10.2521202Z /dev/root       9.6G  3.5G  6.1G  36% /
2025-09-07T16:10:10.2566171Z                total        used        free      shared  buff/cache   available
2025-09-07T16:10:10.2567235Z Mem:           554Mi       242Mi        41Mi       0.0Ki       270Mi       215Mi
2025-09-07T16:10:10.2569214Z Swap:             0B          0B          0B
2025-09-07T16:10:10.2569889Z === Deployment log capture completed ===
2025-09-07T16:10:10.4209323Z Post job cleanup.
2025-09-07T16:10:10.5063740Z Removed exported credentials at "/home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json".
2025-09-07T16:10:10.5212281Z Post job cleanup.
2025-09-07T16:10:10.6923340Z Post job cleanup.
2025-09-07T16:10:10.7801751Z Removed exported credentials at "/home/runner/work/red-legion-bots/red-legion-bots/gha-creds-710a04cc13d8758d.json".
2025-09-07T16:10:10.7914765Z Post job cleanup.
2025-09-07T16:10:10.8915073Z [command]/usr/bin/git version
2025-09-07T16:10:10.8966539Z git version 2.51.0
2025-09-07T16:10:10.9013384Z Temporarily overriding HOME='/home/runner/work/_temp/0ff0be1d-39e5-48d8-b292-6432c444198b' before making global git config changes
2025-09-07T16:10:10.9015185Z Adding repository directory to the temporary git global config as a safe directory
2025-09-07T16:10:10.9020538Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/red-legion-bots/red-legion-bots
2025-09-07T16:10:10.9061929Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-09-07T16:10:10.9100058Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-09-07T16:10:10.9343281Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-09-07T16:10:10.9366430Z http.https://github.com/.extraheader
2025-09-07T16:10:10.9379919Z [command]/usr/bin/git config --local --unset-all http.https://github.com/.extraheader
2025-09-07T16:10:10.9414118Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-09-07T16:10:10.9754460Z Cleaning up orphan processes
